<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of BuildMeta</title>
  <meta name="keywords" content="BuildMeta">
  <meta name="description" content="% function for building surrogate model">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html GRENAT --><!-- # src --><!-- menu.html surrogate -->
<h1>BuildMeta
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>% function for building surrogate model</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [outMeta]=BuildMeta(samplingIn,respIn,gradIn,metaData) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">% function for building surrogate model
 L. LAURENT -- 04/12/2011 -- luc.laurent@lecnam.net</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="KRGBuild.html" class="code" title="function [ret]=KRGBuild(samplingIn,respIn,gradIn,metaData,missData)">KRGBuild</a>	% function for building kriging and cokriging surrogate model</li><li><a href="PrepIn.html" class="code" title="function ret=PrepIn(samplingIn,respIn,gradIn,metaData,missData)">PrepIn</a>	% Preparation for Indirect Gradient-Enhanced Surrogate Models</li><li><a href="RBFBuild.html" class="code" title="function ret=RBFBuild(samplingIn,respIn,gradIn,metaData)">RBFBuild</a>	% Function for building Radial Basis Function surrogate model</li><li><a href="SVRBuild.html" class="code" title="function [ret]=SVRBuild(samplingIn,respIn,gradIn,metaData,missData)">SVRBuild</a>	% function for building gradient and non-gradient based SVR</li><li><a href="../../../GRENAT/src/various/mesuTime.html" class="code" title="">mesuTime</a>	MultiDOE - Toolbox for sampling a bounded space</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../GRENAT/GRENAT.html" class="code" title="">GRENAT</a>	% GRENAT class for manipulating gradient-enhanced metamodels</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function [Indirect,Classical]=CheckGE(typeSurrogate)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%% function for building surrogate model</span>
0002 <span class="comment">% L. LAURENT -- 04/12/2011 -- luc.laurent@lecnam.net</span>
0003 
0004 <span class="comment">%     GRENAT - GRadient ENhanced Approximation Toolbox</span>
0005 <span class="comment">%     A toolbox for generating and exploiting gradient-enhanced surrogate models</span>
0006 <span class="comment">%     Copyright (C) 2016  Luc LAURENT &lt;luc.laurent@lecnam.net&gt;</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%     This program is free software: you can redistribute it and/or modify</span>
0009 <span class="comment">%     it under the terms of the GNU General Public License as published by</span>
0010 <span class="comment">%     the Free Software Foundation, either version 3 of the License, or</span>
0011 <span class="comment">%     (at your option) any later version.</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%     This program is distributed in the hope that it will be useful,</span>
0014 <span class="comment">%     but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
0015 <span class="comment">%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
0016 <span class="comment">%     GNU General Public License for more details.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%     You should have received a copy of the GNU General Public License</span>
0019 <span class="comment">%     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
0020 
0021 <a name="_sub0" href="#_subfunctions" class="code">function [outMeta]=BuildMeta(samplingIn,respIn,gradIn,metaData)</a>
0022 
0023 fprintf(<span class="string">'=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=\n'</span>)
0024 fprintf(<span class="string">'    &gt;&gt;&gt; BUILDING SURROGATE MODEL &lt;&lt;&lt;\n'</span>);
0025 countTime=<a href="../../../GRENAT/src/various/mesuTime.html" class="code" title="">mesuTime</a>;
0026 <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0027 <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0028 <span class="comment">%taking into account gradients or not</span>
0029 availGrad=false;
0030 availGradTxt=<span class="string">'No'</span>;
0031 <span class="keyword">if</span>  ~isempty(gradIn);
0032     availGrad=true;
0033     availGradTxt=<span class="string">'Yes'</span>;
0034 <span class="keyword">end</span>
0035 fprintf(<span class="string">'\n++ Gradients are available: %s\n'</span>,availGradTxt);
0036 <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0037 <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0038 <span class="comment">%number of design variables</span>
0039 np=size(samplingIn,2);
0040 <span class="comment">%number of sample points</span>
0041 ns=size(samplingIn,1);
0042 fprintf(<span class="string">' &gt;&gt; Number of design variables: %d \n &gt;&gt; Number of sample points: %d\n'</span>,np,ns);
0043 
0044 <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0045 <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0046 <span class="comment">%%%%%%% Building various surrogate models</span>
0047 <span class="comment">%variable for storing informations</span>
0048 outMeta=[];
0049 <span class="comment">%type of surrogate model</span>
0050 typeMeta=metaData.type;
0051 
0052 <span class="comment">%check indirect, classical or non-gradient-based approach</span>
0053 [InGE,cGE]=<a href="#_sub1" class="code" title="subfunction [Indirect,Classical]=CheckGE(typeSurrogate)">CheckGE</a>(typeMeta);
0054 <span class="comment">%%in the case of Indirect-gradient-based approach</span>
0055 <span class="keyword">if</span> InGE
0056     IndirectData=<a href="PrepIn.html" class="code" title="function ret=PrepIn(samplingIn,respIn,gradIn,metaData,missData)">PrepIn</a>(samplingIn,respIn,gradIn,metaData,metaData.miss);
0057     samplingOk=IndirectData.new.sampling;
0058     respOk=IndirectData.new.resp;
0059     gradOk=[];
0060     fprintf(<span class="string">'\n%s\n'</span>,<span class="string">'&gt;&gt; Indirect gradient-enhanced approach'</span>);
0061 <span class="keyword">elseif</span> cGE
0062     samplingOk=samplingIn;
0063     respOk=respIn;
0064     gradOk=gradIn;
0065 <span class="keyword">else</span>
0066     samplingOk=samplingIn;
0067     respOk=respIn;
0068     gradOk=[];
0069 <span class="keyword">end</span>
0070 
0071 <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0072 <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0073 <span class="comment">%Building surrogate model</span>
0074 <span class="keyword">switch</span> typeMeta
0075     <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0076     <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0077     <span class="keyword">case</span> <span class="string">'SWF'</span>
0078         <span class="comment">%% Building of the 'Shepard Weighting Functions' surrogate model</span>
0079         outMeta=SWFBuild(samplingOk,respOk,gradOk,metaData);
0080         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0081         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0082     <span class="keyword">case</span> {<span class="string">'RBF'</span>,<span class="string">'InRBF'</span>,<span class="string">'GRBF'</span>}
0083         <span class="comment">%% Building of the (Gradient-Enhanced) Radial Basis Functions (RBF/GRBF)</span>
0084         outMeta=<a href="RBFBuild.html" class="code" title="function ret=RBFBuild(samplingIn,respIn,gradIn,metaData)">RBFBuild</a>(samplingOk,respOk,gradOk,metaData);
0085         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0086         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0087     <span class="keyword">case</span> {<span class="string">'KRG'</span>,<span class="string">'InKRG'</span>,<span class="string">'GKRG'</span>}
0088         <span class="comment">%% Building of the (Gradient-Enhanced) Kriging/Cokriging (KRG/GKRG)</span>
0089         outMeta=<a href="KRGBuild.html" class="code" title="function [ret]=KRGBuild(samplingIn,respIn,gradIn,metaData,missData)">KRGBuild</a>(samplingOk,respOk,gradOk,metaData);
0090         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0091         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0092     <span class="keyword">case</span> {<span class="string">'SVR'</span>,<span class="string">'InSVR'</span>,<span class="string">'GSVR'</span>}
0093         <span class="comment">%% Building of the (Gradient-Enhanced) SVR (SVR/GSVR)</span>
0094         outMeta=<a href="SVRBuild.html" class="code" title="function [ret]=SVRBuild(samplingIn,respIn,gradIn,metaData,missData)">SVRBuild</a>(samplingOk,respOk,gradOk,metaData);
0095         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0096         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0097     <span class="keyword">case</span> {<span class="string">'DACE'</span>,<span class="string">'InDACE'</span>}
0098         <span class="comment">%% Construction du metamodele de Krigeage (DACE)</span>
0099         fprintf(<span class="string">'\n%s\n'</span>,[textd <span class="string">'Krigeage (Toolbox DACE)'</span> textf]);
0100         <span class="keyword">if</span> metaData.para.estim
0101             <span class="keyword">switch</span> metaData.corr
0102                 <span class="keyword">case</span> {<span class="string">'correxpg'</span>}
0103                     lb=[metaData.para.l_min.*ones(1,np), metaData.para.p_min];
0104                     ub=[metaData.para.l_max.*ones(1,np), metaData.para.p_max];
0105                 <span class="keyword">otherwise</span>
0106                     lb=metaData.para.l_min.*ones(np,1);
0107                     ub=metaData.para.l_max.*ones(np,1);
0108             <span class="keyword">end</span>
0109             theta0=(ub-lb)./2;
0110             [dace.model,dace.perf]=dacefit(samplingN,respN,metaData.regr,metaData.corr,theta0,lb,ub);
0111         <span class="keyword">else</span>
0112             <span class="keyword">switch</span> metaData.corr
0113                 <span class="keyword">case</span> {<span class="string">'correxpg'</span>}
0114                     theta0=[metaData.para.l_val metaData.para.p_val];
0115                 <span class="keyword">otherwise</span>
0116                     theta0=metaData.para.l_val;
0117             <span class="keyword">end</span>
0118             [dace.model,dace.perf]=dacefit(samplingIn,respIn,metaData.regr,metaData.corr,theta0);
0119         <span class="keyword">end</span>
0120         outMeta=dace;
0121         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0122         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0123     <span class="keyword">case</span> <span class="string">'PRG'</span>
0124         ite_prg=1;
0125         outMeta{numMeta}.prg=length(metaData.deg);
0126         <span class="keyword">for</span> degre=metaData.deg
0127             <span class="comment">%% Construction du metamodele de Regression polynomiale</span>
0128             dd=[<span class="string">'-- Degre du polynome \n'</span>,num2str(degre)];
0129             fprintf(dd);
0130             [prg.coef,prg.MSE]=meta_prg(samplingN,respN,degre);
0131             outMeta.prg{ite_prg}=prg;
0132             ite_prg=ite_prg+1;
0133         <span class="keyword">end</span>
0134         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0135         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0136     <span class="keyword">case</span> <span class="string">'ILIN'</span>
0137         <span class="comment">%% Construction du metamodele d'interpolation lineaire</span>
0138         fprintf(<span class="string">'\n%s\n'</span>,[textd  <span class="string">'Interpolation par fonction de base '</span> textf]);
0139         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0140         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0141     <span class="keyword">case</span> <span class="string">'ILAG'</span>
0142         <span class="comment">%% interpolation par fonction de base lineaire</span>
0143         fprintf(<span class="string">'\n%s\n'</span>,[textd  <span class="string">'Interpolation par fonction polynomiale de Lagrange'</span> textf]);
0144         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0145         <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0146     <span class="keyword">otherwise</span>
0147         error([<span class="string">'Wrong type of surrogate model (see. on '</span>,mfilename,<span class="string">')'</span>]);
0148 <span class="keyword">end</span>
0149 
0150 <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0151 <span class="comment">%%%%%%%%=================================%%%%%%%%</span>
0152 <span class="comment">%concatenate data</span>
0153 outMeta.used.sampling=samplingOk;
0154 outMeta.used.resp=respOk;
0155 outMeta.used.grad=gradOk;
0156 outMeta.in.sampling=samplingIn;
0157 outMeta.in.resp=respIn;
0158 outMeta.in.grad=gradIn;
0159 <span class="comment">%outMeta=mergestruct(outMeta,metaData);</span>
0160 outMeta.norm=metaData.norm;
0161 outMeta.miss=metaData.miss;
0162 
0163 countTime.stop;
0164 fprintf(<span class="string">'=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=\n'</span>)
0165 <span class="keyword">end</span>
0166 
0167 <span class="comment">%function for checking if the surrogate model is a classical</span>
0168 <span class="comment">%gradient-enhanced or indirect gradient-enhanced surrogate model</span>
0169 <a name="_sub1" href="#_subfunctions" class="code">function [Indirect,Classical]=CheckGE(typeSurrogate)</a>
0170 <span class="comment">%check Indirect</span>
0171 nn=regexp(typeSurrogate,<span class="string">'^In'</span>,<span class="string">'ONCE'</span>);
0172 Indirect=~isempty(nn);
0173 <span class="comment">%check gradient-enhanced</span>
0174 nn=regexp(typeSurrogate,<span class="string">'^G'</span>,<span class="string">'ONCE'</span>);
0175 Classical=~isempty(nn);
0176 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 09-Sep-2016 20:02:21 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>