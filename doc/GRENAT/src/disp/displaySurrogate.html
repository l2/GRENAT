<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of displaySurrogate</title>
  <meta name="keywords" content="displaySurrogate">
  <meta name="description" content="% function for displaying response surfaces">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html GRENAT --><!-- # src --><!-- menu.html disp -->
<h1>displaySurrogate
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>% function for displaying response surfaces</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function figHandle=displaySurrogate(gridXY,Z,sampling,resp,grad,dispData) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">% function for displaying response surfaces
L. LAURENT   --  22/03/2010   --  luc.laurent@lecnam.net</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="saveDisp.html" class="code" title="function fileFig=saveDisp(num,foldS)">saveDisp</a>	% save figure in file</li><li><a href="../../../GRENAT/src/init/initDisp.html" class="code" title="function dispDef=initDisp()">initDisp</a>	% Initialization of display variables</li><li><a href="../../../GRENAT/src/libs/matlab2tikz.html" class="code" title="">matlab2tikz</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../GRENAT/ExampleUse1D.html" class="code" title="">ExampleUse1D</a>	Example of use of GRENAT without the sampling toolbox</li><li><a href="../../../GRENAT/ExampleUse2D.html" class="code" title="">ExampleUse2D</a>	% Example of use of GRENAT without the sampling toolbox</li><li><a href="../../../GRENAT/ExampleUseDOE.html" class="code" title="">ExampleUseDOE</a>	% Example of use of the GRENAToolbox with the LMTir one</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%% function for displaying response surfaces</span>
0002 <span class="comment">%L. LAURENT   --  22/03/2010   --  luc.laurent@lecnam.net</span>
0003 
0004 <span class="comment">%     GRENAT - GRadient ENhanced Approximation Toolbox</span>
0005 <span class="comment">%     A toolbox for generating and exploiting gradient-enhanced surrogate models</span>
0006 <span class="comment">%     Copyright (C) 2016  Luc LAURENT &lt;luc.laurent@lecnam.net&gt;</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%     This program is free software: you can redistribute it and/or modify</span>
0009 <span class="comment">%     it under the terms of the GNU General Public License as published by</span>
0010 <span class="comment">%     the Free Software Foundation, either version 3 of the License, or</span>
0011 <span class="comment">%     (at your option) any later version.</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%     This program is distributed in the hope that it will be useful,</span>
0014 <span class="comment">%     but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
0015 <span class="comment">%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
0016 <span class="comment">%     GNU General Public License for more details.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%     You should have received a copy of the GNU General Public License</span>
0019 <span class="comment">%     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
0020 
0021 <a name="_sub0" href="#_subfunctions" class="code">function figHandle=displaySurrogate(gridXY,Z,sampling,resp,grad,dispData)</a>
0022 
0023 <span class="comment">%% input parameters:</span>
0024 <span class="comment">%       - gridXY: grid used for plotting the responses surface,</span>
0025 <span class="comment">%       gridXY(:,:,1) and gridXY(:,:,2) in 2D. In 1D, gridXY is only a</span>
0026 <span class="comment">%       vector of reals obtained for instance using linspace</span>
0027 <span class="comment">%       - Z: structure of the data to be plotted</span>
0028 <span class="comment">%           * vZ: value of the function at the grid points</span>
0029 <span class="comment">%           * GZ (nd-array): components of the gradients calculated at the</span>
0030 <span class="comment">%           grid points</span>
0031 <span class="comment">%       - sampling: vector of the sample points (using DOE for instance)</span>
0032 <span class="comment">%       - resp: values at the sample points</span>
0033 <span class="comment">%       - grad: gradients at the sample points</span>
0034 <span class="comment">%       - dispData: structure that contains all options of the function</span>
0035 <span class="comment">%           * dispData.on: active display or not</span>
0036 <span class="comment">%           * dispData.newFig: show in a new figure</span>
0037 <span class="comment">%           * dispData.gridGrad=false: display gradients at the points of the grid</span>
0038 <span class="comment">%           * dispData.sampleGrad=false: display gradients at sample points</span>
0039 <span class="comment">%           * dispData.d3: show 3D plots (surf quiver3...)</span>
0040 <span class="comment">%           * dispData.d2: show 2D plots (plot quiver...)</span>
0041 <span class="comment">%           * dispData.contour: show isolines</span>
0042 <span class="comment">%           * dispData.samplePts: show sample points</span>
0043 <span class="comment">%           * dispData.uni: show surface with only one color</span>
0044 <span class="comment">%           * dispData.color: chosen color</span>
0045 <span class="comment">%           * dispData.render: rendering 3D plots</span>
0046 <span class="comment">%           * dispData.save: save figures using eps &amp; png formats</span>
0047 <span class="comment">%           * dispData.tikz: save figures using Tikz (TeX) format</span>
0048 <span class="comment">%           * dispData.tex: write associated TeX file</span>
0049 <span class="comment">%           * dispData.opt: options for 1D plots</span>
0050 <span class="comment">%           * dispData.title: title of the figure</span>
0051 <span class="comment">%           * dispData.xlabel: name of x-axis</span>
0052 <span class="comment">%           * dispData.ylabel: name of y-axis</span>
0053 <span class="comment">%           * dispData.zlabel: name of z-axis</span>
0054 <span class="comment">%           * dispData.scale: scale the gradients (quiver)</span>
0055 <span class="comment">%           * dispData.directory: directory used for saving figures</span>
0056 <span class="comment">%           * dispData.step: step of the grid used for plotting</span>
0057 <span class="comment">%           * dispData.missData: information about the missing data</span>
0058 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0059 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0060 <span class="comment">%Load default options</span>
0061 dispDef=<a href="../../../GRENAT/src/init/initDisp.html" class="code" title="function dispDef=initDisp()">initDisp</a>;
0062 <span class="comment">%deal with missing options (added to the options structure)</span>
0063 fDef=fieldnames(dispDef);
0064 fAvail=fieldnames(dispData);
0065 fMiss=setxor(fDef,fAvail);
0066 <span class="comment">%adding missing options</span>
0067 <span class="keyword">if</span> ~isempty(fMiss)
0068     fprintf(<span class="string">'Some display options are missing (add its)\n'</span>);
0069     <span class="keyword">for</span> ii=1:numel(fMiss)
0070         fprintf(<span class="string">'%s '</span>,fMiss{ii});
0071         dispData.(fMiss{ii})=dispDef.(fMiss{ii});
0072     <span class="keyword">end</span>
0073     fprintf(<span class="string">'\n'</span>)
0074 <span class="keyword">end</span>
0075 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0076 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0077 figHandle=[];
0078 
0079 <span class="comment">%deal with 1D/2D plots</span>
0080 spa1D=false;spa2D=false;
0081 <span class="keyword">if</span> size(sampling,2)==1
0082     spa1D=true;
0083 <span class="keyword">elseif</span> size(sampling,2)==2
0084     spa2D=true;
0085     <span class="keyword">if</span> size(gridXY,3)&gt;1
0086         gridX=gridXY(:,:,1);
0087         gridY=gridXY(:,:,2);
0088     <span class="keyword">else</span>
0089         gridX=gridXY(:,1);
0090         gridY=gridXY(:,2);
0091     <span class="keyword">end</span>
0092 <span class="keyword">else</span>
0093     dispData.bar=true;
0094 <span class="keyword">end</span>
0095 <span class="comment">%reodering responses</span>
0096 <span class="keyword">if</span> isa(Z,<span class="string">'struct'</span>)
0097     vZ=Z.Z;
0098 <span class="keyword">else</span>
0099     vZ=Z;
0100 <span class="keyword">end</span>
0101 
0102 <span class="comment">%reodering gradients</span>
0103 <span class="keyword">if</span> isfield(Z,<span class="string">'GZ'</span>)&amp;&amp;spa2D
0104     GR1=Z.GZ(:,:,1);
0105     GR2=Z.GZ(:,:,2);
0106 <span class="keyword">end</span>
0107 
0108 <span class="keyword">if</span> ~isfield(Z,<span class="string">'GZ'</span>);dispData.gridGrad=false;<span class="keyword">end</span>
0109 
0110 <span class="comment">%available gradients at sample points</span>
0111 dispData.sampleGrad=~isempty(grad)&amp;&amp;dispData.sampleGrad;
0112 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0113 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0114 <span class="comment">%seeking and dealing with missing data</span>
0115 listPtsOk=1:size(sampling,1);
0116 listMissResp=[];
0117 listMissGrad=[];
0118 listMissBoth=[];
0119 <span class="keyword">if</span> isfield(dispData,<span class="string">'missData'</span>)
0120     <span class="keyword">if</span> dispData.missData.resp.on
0121         listMissResp=unique(dispData.missData.resp.ixMiss(:));
0122         <span class="keyword">for</span> ii=1:numel(listMissResp)
0123             ix= listPtsOk==listMissResp(ii);
0124             listPtsOk(ix)=[];
0125         <span class="keyword">end</span>
0126     <span class="keyword">end</span>
0127     <span class="keyword">if</span> dispData.missData.grad.on
0128         listMissGrad=unique(dispData.missData.grad.ix_manq(:,1));
0129         <span class="keyword">for</span> ii=1:numel(listMissGrad)
0130             ix= listPtsOk==listMissGrad(ii);
0131             listPtsOk(ix)=[];
0132         <span class="keyword">end</span>
0133     <span class="keyword">end</span>
0134     <span class="keyword">if</span> dispData.missData.eval.on|| dispData.missData.grad.on
0135         listMissBoth=intersect(listMissResp,listMissGrad);
0136         <span class="keyword">for</span> ii=1:numel(listMissBoth)
0137             ix= listMissResp==listMissBoth(ii);
0138             listMissResp(ix)=[];
0139             ix= listMissGrad==listMissBoth(ii);
0140             listMissGrad(ix)=[];
0141         <span class="keyword">end</span>
0142     <span class="keyword">end</span>
0143 <span class="keyword">end</span>
0144 
0145 <span class="comment">%active display</span>
0146 <span class="keyword">if</span> dispData.on
0147     <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0148     <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0149     <span class="comment">%display graph in a new window</span>
0150     <span class="keyword">if</span> dispData.newFig
0151         figHandle=figure;
0152     <span class="keyword">else</span>
0153         hold on
0154     <span class="keyword">end</span>
0155     
0156     <span class="comment">%display in 2D (2 design parameters)</span>
0157     <span class="keyword">if</span> spa2D
0158         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0159         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0160         <span class="comment">%%scale gradients</span>
0161         <span class="keyword">if</span> dispData.gridGrad
0162             <span class="comment">%compute norm of the gradients</span>
0163             ngr=zeros(size(GR1));
0164             <span class="keyword">for</span> ii=1:size(GR1,1)*size(GR1,2)
0165                 ngr(ii)=norm([GR1(ii) GR2(ii)],2);
0166             <span class="keyword">end</span>
0167             <span class="comment">%seek maximum norm of the gradients</span>
0168             nm=max(max(ngr));
0169             n1=max(max(abs(GR1)));
0170             n2=max(max(abs(GR2)));
0171             
0172             <span class="comment">%minimal size of the display grid</span>
0173             gx=gridX-gridX(1);
0174             ixG= gx&gt;0;
0175             sizeG(1)=min(min(gx(ixG)));
0176             gy=gridY-gridY(1);
0177             ixG= gy&gt;0;
0178             sizeG(2)=min(min(gy(ixG)));
0179             
0180             <span class="comment">%size of the biggest arrow  (used for displaying gradients)</span>
0181             paraAr=0.9;
0182             sizeGfinal=paraAr*sizeG;
0183             
0184             <span class="comment">%scale factor</span>
0185             scaleFactor=sizeGfinal./[n1 n2];
0186         <span class="keyword">end</span>
0187         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0188         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0189         <span class="comment">%show 3D surface</span>
0190         <span class="keyword">if</span> dispData.d3
0191             <span class="comment">%shwo contour</span>
0192             <span class="keyword">if</span> dispData.contour
0193                 surfc(gridX,gridY,vZ);
0194                 <span class="keyword">if</span> dispData.uni
0195                     <span class="comment">%show surface with unique color</span>
0196                     set(h,<span class="string">'FaceColor'</span>,dispData.color,<span class="string">'EdgeColor'</span>,dispData.color);
0197                 <span class="keyword">end</span>
0198             <span class="keyword">else</span>
0199                 h=surf(gridX,gridY,vZ);
0200                 <span class="keyword">if</span> dispData.uni
0201                     <span class="comment">%show surface with unique color</span>
0202                     set(h,<span class="string">'FaceColor'</span>,dispData.color,<span class="string">'EdgeColor'</span>,dispData.color);
0203                 <span class="keyword">end</span>
0204             <span class="keyword">end</span>
0205             
0206             <span class="comment">%show sample points</span>
0207             <span class="keyword">if</span> dispData.samplePts
0208                 hold on
0209                 
0210                 <span class="comment">%show sample points on which all information is known</span>
0211                 plot3(sampling(listPtsOk,1),sampling(listPtsOk,2),resp(listPtsOk),<span class="keyword">...</span>
0212                     <span class="string">'.'</span>,<span class="keyword">...</span>
0213                     <span class="string">'MarkerEdgeColor'</span>,<span class="string">'k'</span>,<span class="keyword">...</span>
0214                     <span class="string">'MarkerFaceColor'</span>,<span class="string">'k'</span>,<span class="keyword">...</span>
0215                     <span class="string">'MarkerSize'</span>,15);
0216                 <span class="comment">%show sample points on which response is missing</span>
0217                 plot3(sampling(listMissResp,1),sampling(listMissResp,2),resp(listMissResp),<span class="keyword">...</span>
0218                     <span class="string">'rs'</span>,<span class="keyword">...</span>
0219                     <span class="string">'MarkerEdgeColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0220                     <span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0221                     <span class="string">'MarkerSize'</span>,7);
0222                 <span class="comment">%show sample points on which gradient(s) is missing</span>
0223                 plot3(sampling(listMissGrad,1),sampling(listMissGrad,2),resp(listMissGrad),<span class="keyword">...</span>
0224                     <span class="string">'v'</span>,<span class="keyword">...</span>
0225                     <span class="string">'MarkerEdgeColor'</span>,<span class="string">'g'</span>,<span class="keyword">...</span>
0226                     <span class="string">'MarkerFaceColor'</span>,<span class="string">'g'</span>,<span class="keyword">...</span>
0227                     <span class="string">'MarkerSize'</span>,15);
0228                 <span class="comment">%show sample points on which gradient(s) and response are missing</span>
0229                 plot3(sampling(listMissBoth,1),sampling(listMissBoth,2),resp(listMissBoth),<span class="keyword">...</span>
0230                     <span class="string">'d'</span>,<span class="keyword">...</span>
0231                     <span class="string">'MarkerEdgeColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0232                     <span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0233                     <span class="string">'MarkerSize'</span>,15);
0234             <span class="keyword">end</span>
0235             
0236             <span class="comment">%show gradients</span>
0237             <span class="keyword">if</span> dispData.sampleGrad
0238                 <span class="comment">%find vectors with biggest slopes (in the direction of</span>
0239                 <span class="comment">%descent of the gradient</span>
0240                 
0241                 <span class="comment">%%TO BE CHECK</span>
0242                 vec.X=-GR1;
0243                 vec.Y=-GR2;
0244                 vec.Z=-GR1.^2-GR2.^2;
0245                 <span class="comment">%normalization of the gradient with the biggest slopes</span>
0246                 vec.N=sqrt(vec.X.^2+vec.Y.^2+vec.Z.^2);
0247                 vec.Xn=vec.X./vec.N;
0248                 vec.Yn=vec.Y./vec.N;
0249                 vec.Zn=vec.Z./vec.N;
0250                 
0251                 <span class="comment">%%TO BE REMOVED IF OK</span>
0252                 <span class="comment">%                 for ii=1:size(GR1,1)*size(GR1,2)</span>
0253                 <span class="comment">%                     vec.X(ii)=-GR1(ii);</span>
0254                 <span class="comment">%                     vec.Y(ii)=-GR2(ii);</span>
0255                 <span class="comment">%                     vec.Z(ii)=-GR1(ii)^2-GR2(ii)^2;</span>
0256                 <span class="comment">%                     %normalisation du vecteur de plus grande pente</span>
0257                 <span class="comment">%                     vec.N(ii)=sqrt(vec.X(ii)^2+vec.Y(ii)^2+vec.Z(ii)^2);</span>
0258                 <span class="comment">%                     vec.Xn(ii)=vec.X(ii)/vec.N(ii);</span>
0259                 <span class="comment">%                     vec.Yn(ii)=vec.Y(ii)/vec.N(ii);</span>
0260                 <span class="comment">%                     vec.Zn(ii)=vec.Z(ii)/vec.N(ii);</span>
0261                 <span class="comment">%                 end</span>
0262                 <span class="comment">%%%%%%%%%%%%%%%</span>
0263                 
0264                 <span class="comment">%maximal size of the design spacedimension maximale espace de conception</span>
0265                 dimm=max(abs(max(max(gridX))-min(min(gridX))),<span class="keyword">...</span>
0266                     abs(max(max(gridY))-min(min(gridY))));
0267                 <span class="comment">%size of the response space</span>
0268                 dimr=abs(max(max(vZ))-min(min(vZ)));
0269                 <span class="comment">%maximal norm of the gradients</span>
0270                 nmax=max(max(vec.N));
0271                 hold on
0272                 <span class="comment">%hcones =coneplot(X,Y,vZ,vec.X,vec.Y,vec.Z,0.1,'nointerp');</span>
0273                 <span class="comment">% hcones=coneplot(X,Y,vZ,GR1,GR2,-ones(size(GR1)),0.1,'nointerp');</span>
0274                 <span class="comment">% set(hcones,'FaceColor','red','EdgeColor','none')</span>
0275                 quiver3(gridX,gridY,vZ,scaleFactor*vec.X,scaleFactor*vec.Y,scaleFactor*vec.Z,<span class="keyword">...</span>
0276                     <span class="string">'b'</span>,<span class="string">'MaxHeadSize'</span>,0.1*dimr/nmax,<span class="string">'AutoScale'</span>,<span class="string">'off'</span>)
0277             <span class="keyword">end</span>
0278             <span class="comment">%axis([min(grille_X(:)) max(grille_X(:)) min(grille_Y(:)) max(grille_Y(:)) min(vZ(:)) max(vZ(:))])</span>
0279         <span class="keyword">end</span>
0280         
0281         
0282         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0283         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0284         <span class="comment">%show 2D surfaces (using contours)</span>
0285         <span class="keyword">if</span> dispData.d2
0286             <span class="comment">%display contours</span>
0287             <span class="keyword">if</span> dispData.contour
0288                 [C,h]=contourf(gridX,gridY,vZ);
0289                 clabel(C,h,<span class="string">'BackgroundColor'</span>,[1 1 .6],<span class="keyword">...</span>
0290                     <span class="string">'Edgecolor'</span>,[.7 .7 .7]);
0291                 set(h,<span class="string">'LineWidth'</span>,2);
0292                 <span class="comment">%display gradients</span>
0293                 <span class="keyword">if</span> dispData.gridGrad
0294                     hold on;
0295                     <span class="comment">%scaling the gradients</span>
0296                     <span class="keyword">if</span> dispData.scale
0297                         quiver(gridX,gridY,scaleFactor(1)*GR1,scaleFactor(2)*GR2,<span class="string">'Color'</span>,<span class="string">'b'</span>,<span class="string">'AutoScale'</span>,<span class="string">'off'</span>,<span class="string">'MaxHeadSize'</span>,0);
0298                     <span class="keyword">else</span>
0299                         quiver(gridX,gridY,GR1,GR2,<span class="string">'Color'</span>,<span class="string">'b'</span>,<span class="string">'AutoScale'</span>,<span class="string">'off'</span>);
0300                     <span class="keyword">end</span>
0301                 <span class="keyword">end</span>
0302                 <span class="comment">%show sample points</span>
0303                 <span class="keyword">if</span> dispData.samplePts
0304                     hold on
0305                     <span class="comment">%show sample points on which all information is known</span>
0306                     plot(sampling(listPtsOk,1),sampling(listPtsOk,2),<span class="keyword">...</span>
0307                         <span class="string">'o'</span>,<span class="keyword">...</span>
0308                         <span class="string">'LineWidth'</span>,2,<span class="keyword">...</span>
0309                         <span class="string">'MarkerEdgeColor'</span>,<span class="string">'k'</span>,<span class="keyword">...</span>
0310                         <span class="string">'MarkerFaceColor'</span>,<span class="string">'g'</span>,<span class="keyword">...</span>
0311                         <span class="string">'MarkerSize'</span>,7);
0312                     <span class="comment">%show sample points on which response is missing</span>
0313                     plot(sampling(listMissResp,1),sampling(listMissResp,2),<span class="keyword">...</span>
0314                         <span class="string">'rs'</span>,<span class="keyword">...</span>
0315                         <span class="string">'LineWidth'</span>,2,<span class="keyword">...</span>
0316                         <span class="string">'MarkerEdgeColor'</span>,<span class="string">'k'</span>,<span class="keyword">...</span>
0317                         <span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0318                         <span class="string">'MarkerSize'</span>,7);
0319                     <span class="comment">%show sample points on which gradient(s) is missing</span>
0320                     plot(sampling(listMissGrad,1),sampling(listMissGrad,2),<span class="keyword">...</span>
0321                         <span class="string">'v'</span>,<span class="keyword">...</span>
0322                         <span class="string">'LineWidth'</span>,2,<span class="keyword">...</span>
0323                         <span class="string">'MarkerEdgeColor'</span>,<span class="string">'k'</span>,<span class="keyword">...</span>
0324                         <span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0325                         <span class="string">'MarkerSize'</span>,7);
0326                     <span class="comment">%show sample points on which gradient(s) and response are missing</span>
0327                     plot(sampling(listMissBoth,1),sampling(listMissBoth,2),<span class="keyword">...</span>
0328                         <span class="string">'d'</span>,<span class="keyword">...</span>
0329                         <span class="string">'LineWidth'</span>,2,<span class="keyword">...</span>
0330                         <span class="string">'MarkerEdgeColor'</span>,<span class="string">'k'</span>,<span class="keyword">...</span>
0331                         <span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0332                         <span class="string">'MarkerSize'</span>,7);
0333                     
0334                 <span class="keyword">end</span>
0335                 <span class="comment">%shows gradients</span>
0336                 <span class="keyword">if</span> dispData.sampleGrad
0337                     hold on;
0338                     <span class="comment">%scaling gradients</span>
0339                     <span class="keyword">if</span> dispData.scale
0340                         quiver(sampling(:,1),sampling(:,2),<span class="keyword">...</span>
0341                             scaleFactor(1)*grad(:,1),scaleFactor(2)*grad(:,2),<span class="keyword">...</span>
0342                             <span class="string">'Color'</span>,<span class="string">'g'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'AutoScale'</span>,<span class="string">'off'</span>,<span class="string">'MaxHeadSize'</span>,0);
0343                     <span class="keyword">else</span>
0344                         quiver(sampling(:,1),sampling(:,2),<span class="keyword">...</span>
0345                             grad(:,1),grad(:,2),<span class="keyword">...</span>
0346                             <span class="string">'Color'</span>,<span class="string">'g'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'AutoScale'</span>,<span class="string">'off'</span>);
0347                     <span class="keyword">end</span>
0348                 <span class="keyword">end</span>
0349             <span class="keyword">end</span>
0350         <span class="keyword">end</span>
0351         
0352         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0353         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0354         <span class="comment">%rendering</span>
0355         <span class="keyword">if</span> dispData.render
0356             hlight=light;               <span class="comment">% active light</span>
0357             lighting(<span class="string">'gouraud'</span>)         <span class="comment">% type of rendering</span>
0358             lightangle(hlight,48,70)    <span class="comment">% direction of the light</span>
0359         <span class="keyword">end</span>
0360         
0361         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0362         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0363         <span class="comment">% show label</span>
0364         title(dispData.title);
0365         xlabel(dispData.xlabel);
0366         ylabel(dispData.ylabel);
0367         <span class="keyword">if</span> dispData.d3
0368             zlabel(dispData.zlabel);
0369             view(3)
0370         <span class="keyword">end</span>
0371         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0372         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0373         <span class="comment">%display 1D</span>
0374     <span class="keyword">elseif</span> spa1D
0375         <span class="keyword">if</span> dispData.gridGrad&amp;&amp;isfield(Z,<span class="string">'GZ'</span>)
0376             <span class="keyword">if</span> ~isempty(dispData.color)
0377                 <span class="keyword">if</span> ~isempty(dispData.opt)
0378                     plot(gridXY,Z.GZ,dispData.opt,<span class="string">'Color'</span>,dispData.color,<span class="string">'LineWidth'</span>,2);
0379                 <span class="keyword">else</span>
0380                     plot(gridXY,Z.GZ,<span class="string">'Color'</span>,dispData.color,<span class="string">'LineWidth'</span>,2);
0381                 <span class="keyword">end</span>
0382             <span class="keyword">else</span>
0383                 <span class="keyword">if</span> ~isempty(dispData.opt)
0384                     plot(gridXY,Z.GZ,dispData.opt,<span class="string">'LineWidth'</span>,2);
0385                 <span class="keyword">else</span>
0386                     plot(gridXY,Z.GZ,<span class="string">'LineWidth'</span>,2);
0387                 <span class="keyword">end</span>
0388             <span class="keyword">end</span>
0389         <span class="keyword">else</span>
0390             <span class="keyword">if</span> ~isempty(dispData.color)
0391                 <span class="keyword">if</span> ~isempty(dispData.opt)
0392                     plot(gridXY,vZ,dispData.opt,<span class="string">'Color'</span>,dispData.color,<span class="string">'LineWidth'</span>,2);
0393                 <span class="keyword">else</span>
0394                     plot(gridXY,vZ,<span class="string">'Color'</span>,dispData.color,<span class="string">'LineWidth'</span>,2);
0395                 <span class="keyword">end</span>
0396             <span class="keyword">else</span>
0397                 <span class="keyword">if</span> ~isempty(dispData.opt)
0398                     plot(gridXY,vZ,dispData.opt,<span class="string">'LineWidth'</span>,2);
0399                 <span class="keyword">else</span>
0400                     plot(gridXY,vZ,<span class="string">'LineWidth'</span>,2);
0401                 <span class="keyword">end</span>
0402             <span class="keyword">end</span>
0403         <span class="keyword">end</span>
0404         <span class="comment">%show sample points</span>
0405         <span class="keyword">if</span> dispData.samplePts
0406             hold on
0407             <span class="keyword">if</span> dispData.gridGrad&amp;&amp;isfield(Z,<span class="string">'GZ'</span>);valPlot=grad;<span class="keyword">else</span> valPlot=resp;<span class="keyword">end</span>
0408             <span class="comment">%show sample points on which all information is known</span>
0409             plot(sampling(listPtsOk),valPlot(listPtsOk),<span class="keyword">...</span>
0410                 <span class="string">'rs'</span>,<span class="keyword">...</span>
0411                 <span class="string">'MarkerEdgeColor'</span>,<span class="string">'k'</span>,<span class="keyword">...</span>
0412                 <span class="string">'MarkerFaceColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
0413                 <span class="string">'MarkerSize'</span>,7);
0414             <span class="comment">%show sample points on which response is missing</span>
0415             plot(sampling(listMissResp),valPlot(listMissResp),<span class="keyword">...</span>
0416                 <span class="string">'o'</span>,<span class="keyword">...</span>
0417                 <span class="string">'MarkerEdgeColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0418                 <span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0419                 <span class="string">'MarkerSize'</span>,7);
0420             <span class="comment">%show sample points on which gradient(s) is missing</span>
0421             plot(sampling(listMissGrad),valPlot(listMissGrad),<span class="keyword">...</span>
0422                 <span class="string">'v'</span>,<span class="keyword">...</span>
0423                 <span class="string">'MarkerEdgeColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0424                 <span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0425                 <span class="string">'MarkerSize'</span>,7);
0426             <span class="comment">%show sample points on which gradient(s) and response are missing</span>
0427             plot(sampling(listMissBoth),valPlot(listMissBoth),<span class="keyword">...</span>
0428                 <span class="string">'d'</span>,<span class="keyword">...</span>
0429                 <span class="string">'MarkerEdgeColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0430                 <span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>,<span class="keyword">...</span>
0431                 <span class="string">'MarkerSize'</span>,7);
0432         <span class="keyword">end</span>
0433         title(dispData.title);
0434         xlabel(dispData.xlabel);
0435         ylabel(dispData.ylabel);
0436     <span class="keyword">end</span>
0437     
0438     <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0439     <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0440     <span class="comment">%save figure and create</span>
0441     <span class="keyword">if</span> dispData.save
0442         <span class="keyword">global</span> numPlot
0443         <span class="keyword">if</span> isempty(numPlot); numPlot=1; <span class="keyword">else</span> numPlot=numPlot+1; <span class="keyword">end</span>
0444         fich=<a href="saveDisp.html" class="code" title="function fileFig=saveDisp(num,foldS)">saveDisp</a>(numPlot,dispData.directory);
0445         <span class="keyword">if</span> dispData.tex
0446             fid=fopen([dispData.directory <span class="string">'/fig.tex'</span>],<span class="string">'a+'</span>);
0447             fprintf(fid,<span class="string">'\\figcen{%2.1f}{../%s}{%s}{%s}\n'</span>,0.7,fich,dispData.title,fich);
0448             <span class="comment">%fprintf(fid,'\\verb{%s}\n',fich);</span>
0449             fclose(fid);
0450         <span class="keyword">end</span>
0451     <span class="keyword">end</span>
0452     
0453     <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0454     <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0455     <span class="comment">%Plot responses in nD</span>
0456     <span class="keyword">if</span> dispData.bar
0457         Zs=vZ(:);
0458         nbv=numel(Zs);
0459         <span class="keyword">if</span> ~isempty(dispData.color)
0460             plot(1:nbv,Zs,<span class="string">'o'</span>,<span class="string">'MarkerEdgeColor'</span>,dispData.color,<span class="string">'MarkerFaceColor'</span>,dispData.color,<span class="string">'Markersize'</span>,5);
0461             <span class="comment">%line([1:nb_eval;1:nb_eval],[zeros(1,nb_eval);Zs'],'LineWidth',1,'Color',dispData.color,'lineStyle','--')</span>
0462         <span class="keyword">else</span>
0463             plot(1:nbv,Zs,<span class="string">'o'</span>,<span class="string">'MarkerEdgeColor'</span>,<span class="string">'k'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'k'</span>,<span class="string">'Markersize'</span>,5);
0464             <span class="comment">%line([1:nb_eval;1:nb_eval],[zeros(1,nb_eval);Zs'],'LineWidth',1,'Color',[0. 0. .8],'lineStyle','--')</span>
0465         <span class="keyword">end</span>
0466         title(dispData.title);
0467         xlabel(dispData.xlabel);
0468         ylabel(dispData.ylabel);
0469     <span class="keyword">end</span>
0470     
0471     <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0472     <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0473     <span class="comment">%export using tikz</span>
0474     <span class="keyword">if</span> dispData.tikz
0475         nomfig=[dispData.directory <span class="string">'/fig_'</span> num2str(dispData.num,<span class="string">'%04.0f'</span>) <span class="string">'.tex'</span>];
0476         <a href="../../../GRENAT/src/libs/matlab2tikz.html" class="code" title="">matlab2tikz</a>(nomfig);
0477     <span class="keyword">end</span>
0478     
0479     hold off
0480 <span class="keyword">end</span>
0481 <span class="keyword">end</span>
0482</pre></div>
<hr><address>Generated on Wed 01-Jun-2016 23:36:27 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>