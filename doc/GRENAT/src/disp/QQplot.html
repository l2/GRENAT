<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of QQplot</title>
  <meta name="keywords" content="QQplot">
  <meta name="description" content="% Plot QQ plot (for cross validation)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html GRENATdevel --><!-- # src --><!-- menu.html disp -->
<h1>QQplot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>% Plot QQ plot (for cross validation)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function QQplot(Zref,Zap,opt) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">% Plot QQ plot (for cross validation)
L. LAURENT -- 21/01/2012 -- luc.laurent@lecnam.net</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../GRENATdevel/src/surrogate/@KRG/showCV.html" class="code" title="function showCV(obj)">showCV</a>	% Show the result of the CV</li><li><a href="../../../GRENATdevel/src/surrogate/@RBF/showCV.html" class="code" title="function showCV(obj)">showCV</a>	% Show the result of the CV</li><li><a href="../../../GRENATdevel/src/surrogate/RBFCV.html" class="code" title="function [cv]=RBFCV(dataBloc,data,metaData,type)">RBFCV</a>	% Function for computing various Cross-Validation criteria for RBF/GRBF</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%% Plot QQ plot (for cross validation)</span>
0002 <span class="comment">%L. LAURENT -- 21/01/2012 -- luc.laurent@lecnam.net</span>
0003 
0004 <span class="comment">%     GRENAT - GRadient ENhanced Approximation Toolbox</span>
0005 <span class="comment">%     A toolbox for generating and exploiting gradient-enhanced surrogate models</span>
0006 <span class="comment">%     Copyright (C) 2016  Luc LAURENT &lt;luc.laurent@lecnam.net&gt;</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%     This program is free software: you can redistribute it and/or modify</span>
0009 <span class="comment">%     it under the terms of the GNU General Public License as published by</span>
0010 <span class="comment">%     the Free Software Foundation, either version 3 of the License, or</span>
0011 <span class="comment">%     (at your option) any later version.</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%     This program is distributed in the hope that it will be useful,</span>
0014 <span class="comment">%     but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
0015 <span class="comment">%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
0016 <span class="comment">%     GNU General Public License for more details.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%     You should have received a copy of the GNU General Public License</span>
0019 <span class="comment">%     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
0020 
0021 <a name="_sub0" href="#_subfunctions" class="code">function QQplot(Zref,Zap,opt)</a>
0022 
0023 <span class="comment">% initialization</span>
0024 Zref=Zref(:);
0025 Zap=Zap(:);
0026 <span class="comment">% bounds of the graph</span>
0027 xmin=min([Zref;Zap]);
0028 xmax=max([Zref;Zap]);
0029 
0030 <span class="comment">% ideal line</span>
0031 li=linspace(xmin,xmax,30);
0032 
0033 <span class="comment">% orthogonal projection</span>
0034 projX=(Zref+Zap)/2;
0035 projY=projX;
0036 <span class="comment">%plot(projX,projY,'o','MarkerEdgeColor','b','MarkerFaceColor','b','Markersize',10)</span>
0037 <span class="comment">%lines of projection</span>
0038 
0039 <span class="comment">%seek for extremums</span>
0040 vecX=projX-Zref;
0041 vecY=projY-Zap;
0042 dist=sqrt(vecX.^2+vecY.^2);
0043 <span class="comment">% points above</span>
0044 ind=find(Zap&gt;=Zref);
0045 [~,ptup]=max(dist(ind));
0046 ptup=ind(ptup);
0047 coef=Zap(ptup)-Zref(ptup);
0048 <span class="keyword">if</span> isempty(coef)
0049     coef=0;
0050 <span class="keyword">end</span>
0051 liup=li+coef;
0052 
0053 <span class="comment">% points below</span>
0054 ind=find(Zap&lt;Zref);
0055 [~,ptdown]=max(dist(ind));
0056 ptdown=ind(ptdown);
0057 coef=Zap(ptdown)-Zref(ptdown);
0058 <span class="keyword">if</span> isempty(coef)
0059     coef=0;
0060 <span class="keyword">end</span>
0061 lidown=li+coef;
0062 
0063 <span class="comment">%lines of the bounds</span>
0064 Xp=[li(1);li(1);li(1);li(end);li(end);li(end)];
0065 Yp=[lidown(1);li(1);liup(1);liup(end);li(end);lidown(end)];
0066 
0067 <span class="comment">%if options</span>
0068 newFig=true;
0069 defTitle=<span class="string">'QQ plot'</span>;
0070 defX=<span class="string">'Real'</span>;
0071 defY=<span class="string">'Predicted'</span>;
0072 <span class="keyword">if</span> nargin==3
0073     <span class="keyword">if</span> isfield(opt,<span class="string">'newfig'</span>)
0074         newFig=opt.newfig;
0075     <span class="keyword">end</span>
0076     <span class="keyword">if</span> isfield(opt,<span class="string">'title'</span>)
0077         defTitle=opt.title;
0078     <span class="keyword">end</span>
0079     <span class="keyword">if</span> isfield(opt,<span class="string">'xlabel'</span>)
0080         defX=opt.xlabel;
0081     <span class="keyword">end</span>
0082     <span class="keyword">if</span> isfield(opt,<span class="string">'ylabel'</span>)
0083         defY=opt.ylabel;
0084     <span class="keyword">end</span>
0085     
0086 <span class="keyword">end</span>
0087 
0088 <span class="comment">%graph</span>
0089 <span class="keyword">if</span> newFig
0090     figure;
0091 <span class="keyword">end</span>
0092 hold on
0093 fill(Xp,Yp,[0 0.9 0.99])
0094 plot(li,li,<span class="string">'r'</span>,<span class="string">'LineWidth'</span>,1.5)
0095 axis equal
0096 line([Zref';projX'],[Zap';projY'],<span class="string">'LineWidth'</span>,1,<span class="string">'Color'</span>,[0. 0. .8],<span class="string">'lineStyle'</span>,<span class="string">'--'</span>)
0097 plot(li,liup,<span class="string">'b'</span>,<span class="string">'LineWidth'</span>,1.5,<span class="string">'lineStyle'</span>,<span class="string">'--'</span>)
0098 plot(li,lidown,<span class="string">'b'</span>,<span class="string">'LineWidth'</span>,1.5,<span class="string">'lineStyle'</span>,<span class="string">'--'</span>)
0099 plot(Zref,Zap,<span class="string">'o'</span>,<span class="string">'MarkerEdgeColor'</span>,<span class="string">'k'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'k'</span>,<span class="string">'Markersize'</span>,10)
0100 title(defTitle)
0101 xlabel(defX)
0102 ylabel(defY)
0103 axis([xmin xmax xmin xmax])
0104 hold off
0105 
0106 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 18-Aug-2017 00:34:12 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>