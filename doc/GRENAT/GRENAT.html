<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of GRENAT</title>
  <meta name="keywords" content="GRENAT">
  <meta name="description" content="% GRENAT class for manipulating gradient-enhanced metamodels">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html GRENAT -->
<h1>GRENAT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>% GRENAT class for manipulating gradient-enhanced metamodels</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">% GRENAT class for manipulating gradient-enhanced metamodels
 L. LAURENT -- 26/06/2016 -- luc.laurent@lecnam.net</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="GRENAT.html" class="code" title="">GRENAT</a>	% GRENAT class for manipulating gradient-enhanced metamodels</li><li><a href="initDirGRENAT.html" class="code" title="function foldersLoad=initDirGRENAT(pathcustom,other,flagNested)">initDirGRENAT</a>	% Initialization of the directories (MATLAB's path)</li><li><a href="../GRENAT/src/crit/BuildCI.html" class="code" title="function [ci68,ci95,ci99]=BuildCI(ZZ,var)">BuildCI</a>	% function for building confidence intervals (CI)</li><li><a href="../GRENAT/src/crit/InfillCrit.html" class="code" title="function [ZI,detInfill]=InfillCrit(respMin,Z,varZ,infillData)">InfillCrit</a>	% Compute infill criteria EI/WEI/LCB</li><li><a href="../GRENAT/src/crit/critErrDisp.html" class="code" title="function [err,errV,errNAME]=critErrDisp(Zap,Zref,data)">critErrDisp</a>	% Compute error criteria and display</li><li><a href="../GRENAT/src/disp/dispDate.html" class="code" title="function dispDate(type)">dispDate</a>	% Display date and time</li><li><a href="../GRENAT/src/disp/displaySurrogate.html" class="code" title="function figHandle=displaySurrogate(gridXY,Z,sampling,resp,grad,dispData)">displaySurrogate</a>	% function for displaying response surfaces</li><li><a href="../GRENAT/src/disp/displaySurrogateCI.html" class="code" title="function displaySurrogateCI(Xpts,ic,dispData,Z)">displaySurrogateCI</a>	% Display confidence intervals</li><li><a href="../GRENAT/src/init/initDisp.html" class="code" title="">initDisp</a>	% Initialization of display variables</li><li><a href="../GRENAT/src/init/initMeta.html" class="code" title="">initMeta</a>	% Initialization of the surrogate model</li><li><a href="../GRENAT/src/surrogate/BuildMeta.html" class="code" title="function [outMeta]=BuildMeta(samplingIn,respIn,gradIn,metaData)">BuildMeta</a>	% function for building surrogate model</li><li><a href="../GRENAT/src/surrogate/EvalMeta.html" class="code" title="function [Z]=EvalMeta(evalSample,dataTrain,metaConf,Verb)">EvalMeta</a>	% Evaluation of the surrogate model</li><li><a href="../GRENAT/src/various/CheckInputData.html" class="code" title="function [ret]=CheckInputData(sampling,resp,grad)">CheckInputData</a>	% check input data for finding missing information</li><li><a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>	% Normalization and renormalization of the Data</li><li><a href="../GRENAT/src/various/NormRenormG.html" class="code" title="function [out]=NormRenormG(in,type,infoDataS,infoDataR)">NormRenormG</a>	% normalization and renormalization of the gradient data</li><li><a href="../GRENAT/src/various/checkInterpRG.html" class="code" title="function statusI=checkInterpRG(ZRef,ZApp,type,critR,critG)">checkInterpRG</a>	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="ExampleUse1D.html" class="code" title="">ExampleUse1D</a>	Example of use of GRENAT without the sampling toolbox</li><li><a href="ExampleUse2D.html" class="code" title="">ExampleUse2D</a>	% Example of use of GRENAT without the sampling toolbox</li><li><a href="ExampleUseDOE.html" class="code" title="">ExampleUseDOE</a>	% Example of use of the GRENAToolbox with the MultiDOE one</li><li><a href="GRENAT.html" class="code" title="">GRENAT</a>	% GRENAT class for manipulating gradient-enhanced metamodels</li><li><a href="README.html" class="code" title="">README</a>	</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function obj=GRENAT(typeIn,samplingIn,respIn,gradIn)</a></li><li><a href="#_sub2" class="code">function set.sampling(obj,samplingIn)</a></li><li><a href="#_sub3" class="code">function set.resp(obj,respIn)</a></li><li><a href="#_sub4" class="code">function set.grad(obj,gradIn)</a></li><li><a href="#_sub5" class="code">function set.nonsamplePts(obj,samplingIn)</a></li><li><a href="#_sub6" class="code">function set.type(obj,typeIn)</a></li><li><a href="#_sub7" class="code">function type=get.type(obj)</a></li><li><a href="#_sub8" class="code">function PtS=get.nonsamplePtsOrder(obj)</a></li><li><a href="#_sub9" class="code">function Z=get.nonsampleResp(obj)</a></li><li><a href="#_sub10" class="code">function GZ=get.nonsampleGrad(obj)</a></li><li><a href="#_sub11" class="code">function variance=get.nonsampleVar(obj)</a></li><li><a href="#_sub12" class="code">function err=get.err(obj)</a></li><li><a href="#_sub13" class="code">function normStruct=get.norm(obj)</a></li><li><a href="#_sub14" class="code">function initRunTrain(obj,flag)</a></li><li><a href="#_sub15" class="code">function initGradAvail(obj,flag)</a></li><li><a href="#_sub16" class="code">function initRunEval(obj,flag)</a></li><li><a href="#_sub17" class="code">function dataOut=orderData(obj,dataIn,type)</a></li><li><a href="#_sub18" class="code">function dataOut=normInputData(obj,type,dataIn)</a></li><li><a href="#_sub19" class="code">function dataOut=reNormInputData(obj,type,dataIn)</a></li><li><a href="#_sub20" class="code">function resetNorm(obj)</a></li><li><a href="#_sub21" class="code">function checkMissingData(obj)</a></li><li><a href="#_sub22" class="code">function defineDisp(obj,varargin)</a></li><li><a href="#_sub23" class="code">function train(obj)</a></li><li><a href="#_sub24" class="code">function [Z,GZ,variance]=eval(obj,nonsamplePts)</a></li><li><a href="#_sub25" class="code">function [ZI,detI]=evalInfill(obj,nonsamplePts)</a></li><li><a href="#_sub26" class="code">function [statusR,statusG]=checkInterp(obj)</a></li><li><a href="#_sub27" class="code">function [ci68,ci95,ci99]=evalCI(obj,nonsamplePts)</a></li><li><a href="#_sub28" class="code">function [ci68,ci95,ci99]=CI(obj,nonsamplePts)</a></li><li><a href="#_sub29" class="code">function errCalc(obj)</a></li><li><a href="#_sub30" class="code">function defineRef(obj,varargin)</a></li><li><a href="#_sub31" class="code">function [okAll,okSample,okResp,okGrad]=checkRef(obj)</a></li><li><a href="#_sub32" class="code">function conf(obj,varargin)</a></li><li><a href="#_sub33" class="code">function show(obj,varargin)</a></li><li><a href="#_sub34" class="code">function show1D(obj)</a></li><li><a href="#_sub35" class="code">function show2D(obj)</a></li><li><a href="#_sub36" class="code">function showRespRef(obj)</a></li><li><a href="#_sub37" class="code">function showGradRef(obj,nbG)</a></li><li><a href="#_sub38" class="code">function showResp(obj)</a></li><li><a href="#_sub39" class="code">function showGrad(obj,nbG)</a></li><li><a href="#_sub40" class="code">function showCI(obj,ciVal,nonsamplePts)</a></li><li><a href="#_sub41" class="code">function isF=isfield(obj,field)</a></li><li><a href="#_sub42" class="code">function info=affectTxtProp()</a></li><li><a href="#_sub43" class="code">function dispTableTwoColumnsStruct(tableFiedIn,structIn)</a></li><li><a href="#_sub44" class="code">function dispTableTwoColumns(tableA,tableB)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%% GRENAT class for manipulating gradient-enhanced metamodels</span>
0002 <span class="comment">% L. LAURENT -- 26/06/2016 -- luc.laurent@lecnam.net</span>
0003 
0004 <span class="comment">%     GRENAT - GRadient ENhanced Approximation Toolbox</span>
0005 <span class="comment">%     A toolbox for generating and exploiting gradient-enhanced surrogate models</span>
0006 <span class="comment">%     Copyright (C) 2016  Luc LAURENT &lt;luc.laurent@lecnam.net&gt;</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%     This program is free software: you can redistribute it and/or modify</span>
0009 <span class="comment">%     it under the terms of the GNU General Public License as published by</span>
0010 <span class="comment">%     the Free Software Foundation, either version 3 of the License, or</span>
0011 <span class="comment">%     (at your option) any later version.</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%     This program is distributed in the hope that it will be useful,</span>
0014 <span class="comment">%     but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
0015 <span class="comment">%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
0016 <span class="comment">%     GNU General Public License for more details.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%     You should have received a copy of the GNU General Public License</span>
0019 <span class="comment">%     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
0020 
0021 classdef <a href="GRENAT.html" class="code" title="">GRENAT</a> &lt; handle
0022     
0023     properties
0024         <span class="comment">%building</span>
0025         sampling=[];
0026         resp=[];
0027         grad=[];
0028         samplingN=[];
0029         respN=[];
0030         gradN=[];
0031         <span class="comment">%evaluating</span>
0032         nonsamplePts=[];
0033         nonsampleResp=[];
0034         nonsampleGrad=[];
0035         nonsamplePtsOrder=[];
0036         nonsampleRespOrder=[];
0037         nonsampleGradOrder=[];
0038         nonsamplePtsN=[];
0039         nonsampleRespN=[];
0040         nonsampleGradN=[];
0041         sizeNonSample=zeros(1,3);
0042         nonsampleVar=[];
0043         nonsampleVarOrder=[];
0044         nonsampleCI=struct(<span class="string">'ci68'</span>,[],<span class="string">'ci95'</span>,[],<span class="string">'ci98'</span>,[]);
0045         nonsampleEI=[];
0046         <span class="comment">%normalization data</span>
0047         norm;
0048         normMeanS;
0049         normStdS;
0050         normMeanR;
0051         normStdR;
0052         <span class="comment">%</span>
0053         err=[];
0054         <span class="comment">%reference</span>
0055         sampleRef=[];
0056         respRef=[];
0057         gradRef=[];
0058         <span class="comment">%structures &amp; class for storing configuration and data</span>
0059         confMeta;   <span class="comment">%metamodel configuration</span>
0060         dataTrain;  <span class="comment">%training data</span>
0061         confDisp;   <span class="comment">%display configuration</span>
0062         miss;       <span class="comment">%missing data</span>
0063     <span class="keyword">end</span>
0064     properties (Dependent)
0065         type;
0066     <span class="keyword">end</span>
0067     
0068     properties (Access = private)
0069         runTrain=true; <span class="comment">%flag for checking if the training is obsolete</span>
0070         runEval=true; <span class="comment">%flag for checking if the training is obsolete</span>
0071         gradAvail=false; <span class="comment">%flag for availability of the gradients</span>
0072         runErr=true; <span class="comment">%flag for computation of the error</span>
0073         normSamplePtsIn=false; <span class="comment">%flag for checking if the input data are normalized</span>
0074         normRespIn=false; <span class="comment">%flag for checking if the input data are normalized</span>
0075         runMissingData=true; <span class="comment">%flag for checking missing data</span>
0076         nbSubplot=0; <span class="comment">%number of subplot for display</span>
0077     <span class="keyword">end</span>
0078     properties (Access = private,Constant)
0079         infoProp=<a href="#_sub42" class="code" title="subfunction info=affectTxtProp()">affectTxtProp</a>;
0080     <span class="keyword">end</span>
0081     
0082     methods
0083         <span class="comment">%construction</span>
0084         <a name="_sub0" href="#_subfunctions" class="code">function obj=GRENAT(typeIn,samplingIn,respIn,gradIn)</a>
0085             <span class="comment">%load directories on the path</span>
0086             <a href="initDirGRENAT.html" class="code" title="function foldersLoad=initDirGRENAT(pathcustom,other,flagNested)">initDirGRENAT</a>;
0087             <span class="comment">%</span>
0088             fprintf(<span class="string">'=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=\n'</span>);
0089             fprintf(<span class="string">'=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=\n'</span>);
0090             fprintf(<span class="string">' Create GRENAT Object \n'</span>)
0091             <span class="comment">%the date and time</span>
0092             <a href="../GRENAT/src/disp/dispDate.html" class="code" title="function dispDate(type)">dispDate</a>;
0093             <span class="comment">%load default configuration</span>
0094             obj.confMeta=<a href="../GRENAT/src/init/initMeta.html" class="code" title="">initMeta</a>;
0095             <span class="comment">%load display configuration</span>
0096             obj.confDisp=<a href="../GRENAT/src/init/initDisp.html" class="code" title="">initDisp</a>;
0097             <span class="comment">%specific configuration</span>
0098             <span class="keyword">if</span> nargin&gt;0;obj.confMeta.type=typeIn;<span class="keyword">end</span>
0099             <span class="keyword">if</span> nargin&gt;1;obj.sampling=samplingIn;<span class="keyword">end</span>
0100             <span class="keyword">if</span> nargin&gt;2;obj.resp=respIn;<span class="keyword">end</span>
0101             <span class="keyword">if</span> nargin&gt;3;obj.grad=gradIn;<span class="keyword">end</span>
0102         <span class="keyword">end</span>
0103         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0104         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0105         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0106         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0107         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0108         <span class="comment">%setter for the sampling</span>
0109         <a name="_sub1" href="#_subfunctions" class="code">function set.sampling(obj,samplingIn)</a>
0110             <span class="keyword">if</span> ~isempty(samplingIn)
0111                 obj.sampling=samplingIn;
0112                 <a href="#_sub14" class="code" title="subfunction initRunTrain(obj,flag)">initRunTrain</a>(obj,true);
0113                 <a href="#_sub20" class="code" title="subfunction resetNorm(obj)">resetNorm</a>(obj);
0114             <span class="keyword">else</span>
0115                 fprintf(<span class="string">'ERROR: Empty array of sample points\n'</span>);
0116             <span class="keyword">end</span>
0117         <span class="keyword">end</span>
0118         <span class="comment">%setter for the responses</span>
0119         <a name="_sub2" href="#_subfunctions" class="code">function set.resp(obj,respIn)</a>
0120             <span class="keyword">if</span> ~isempty(respIn)
0121                 obj.resp=respIn;
0122                 <a href="#_sub14" class="code" title="subfunction initRunTrain(obj,flag)">initRunTrain</a>(obj,true);
0123             <span class="keyword">else</span>
0124                 fprintf(<span class="string">'ERROR: Empty array of responses\n'</span>);
0125             <span class="keyword">end</span>
0126         <span class="keyword">end</span>
0127         <span class="comment">%setter for the gradients</span>
0128         <a name="_sub3" href="#_subfunctions" class="code">function set.grad(obj,gradIn)</a>
0129             <span class="keyword">if</span> ~isempty(gradIn)
0130                 obj.grad=gradIn;
0131                 <a href="#_sub14" class="code" title="subfunction initRunTrain(obj,flag)">initRunTrain</a>(obj,true);
0132                 <a href="#_sub15" class="code" title="subfunction initGradAvail(obj,flag)">initGradAvail</a>(obj,true);
0133             <span class="keyword">end</span>
0134         <span class="keyword">end</span>
0135         <span class="comment">%setter for the non sample points</span>
0136         <a name="_sub4" href="#_subfunctions" class="code">function set.nonsamplePts(obj,samplingIn)</a>
0137             <span class="keyword">if</span> ~isempty(samplingIn)
0138                 obj.nonsamplePts=samplingIn;
0139                 <a href="#_sub16" class="code" title="subfunction initRunEval(obj,flag)">initRunEval</a>(obj,true);
0140             <span class="keyword">end</span>
0141         <span class="keyword">end</span>
0142          <span class="comment">%setter for the type of metamodel</span>
0143         <a name="_sub5" href="#_subfunctions" class="code">function set.type(obj,typeIn)</a>
0144             obj.confMeta.type=typeIn;
0145         <span class="keyword">end</span>
0146         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0147         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0148         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0149         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0150         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0151         <span class="comment">%getter for the type of metamodel</span>
0152         <a name="_sub6" href="#_subfunctions" class="code">function type=get.type(obj)</a>
0153             type=obj.confMeta.type;
0154         <span class="keyword">end</span>
0155         <span class="comment">%setter for the non sample points</span>
0156         <a name="_sub7" href="#_subfunctions" class="code">function PtS=get.nonsamplePtsOrder(obj)</a>
0157             PtS=<a href="#_sub17" class="code" title="subfunction dataOut=orderData(obj,dataIn,type)">orderData</a>(obj,obj.nonsamplePts,<span class="string">'sampleIn'</span>);
0158         <span class="keyword">end</span>
0159         <span class="comment">%getter for the responses at the non sample points</span>
0160         <a name="_sub8" href="#_subfunctions" class="code">function Z=get.nonsampleResp(obj)</a>
0161             <span class="keyword">if</span> obj.runEval;<a href="#_sub24" class="code" title="subfunction [Z,GZ,variance]=eval(obj,nonsamplePts)">eval</a>(obj);<span class="keyword">end</span>
0162             Z=<a href="#_sub17" class="code" title="subfunction dataOut=orderData(obj,dataIn,type)">orderData</a>(obj,obj.nonsampleRespOrder,<span class="string">'respOut'</span>);
0163         <span class="keyword">end</span>
0164         <span class="comment">%getter for the gradients at the non sample points</span>
0165         <a name="_sub9" href="#_subfunctions" class="code">function GZ=get.nonsampleGrad(obj)</a>
0166             <span class="keyword">if</span> obj.runEval;<a href="#_sub24" class="code" title="subfunction [Z,GZ,variance]=eval(obj,nonsamplePts)">eval</a>(obj);<span class="keyword">end</span>
0167             GZ=<a href="#_sub17" class="code" title="subfunction dataOut=orderData(obj,dataIn,type)">orderData</a>(obj,obj.nonsampleGradOrder,<span class="string">'gradOut'</span>);
0168         <span class="keyword">end</span>
0169         <span class="comment">%getter for the variance at the non sample points</span>
0170         <a name="_sub10" href="#_subfunctions" class="code">function variance=get.nonsampleVar(obj)</a>
0171             <span class="keyword">if</span> obj.runEval;<a href="#_sub24" class="code" title="subfunction [Z,GZ,variance]=eval(obj,nonsamplePts)">eval</a>(obj);<span class="keyword">end</span>
0172             variance=<a href="#_sub17" class="code" title="subfunction dataOut=orderData(obj,dataIn,type)">orderData</a>(obj,obj.nonsampleVarOrder,<span class="string">'respOut'</span>);
0173         <span class="keyword">end</span>
0174         <span class="comment">%getter for error values</span>
0175         <a name="_sub11" href="#_subfunctions" class="code">function err=get.err(obj)</a>
0176             <span class="keyword">if</span> obj.runErr;<a href="#_sub29" class="code" title="subfunction errCalc(obj)">errCalc</a>(obj);<span class="keyword">end</span>
0177             err=obj.err;
0178         <span class="keyword">end</span>
0179         <span class="comment">%getter for normalization data structure</span>
0180         <a name="_sub12" href="#_subfunctions" class="code">function normStruct=get.norm(obj)</a>
0181             normStruct.sampling.mean=obj.normMeanS;
0182             normStruct.sampling.std=obj.normStdS;
0183             normStruct.resp.mean=obj.normMeanR;
0184             normStruct.resp.std=obj.normStdR;
0185             normStruct.on=obj.confMeta.normOn;
0186         <span class="keyword">end</span>
0187         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0188         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0189         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0190         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0191         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0192         <span class="comment">%initialize flags</span>
0193         <a name="_sub13" href="#_subfunctions" class="code">function initRunTrain(obj,flag)</a>
0194             obj.runTrain=flag;
0195         <span class="keyword">end</span>
0196         <a name="_sub14" href="#_subfunctions" class="code">function initGradAvail(obj,flag)</a>
0197             obj.gradAvail=flag;
0198         <span class="keyword">end</span>
0199         <a name="_sub15" href="#_subfunctions" class="code">function initRunEval(obj,flag)</a>
0200             obj.runEval=flag;
0201         <span class="keyword">end</span>
0202         <span class="comment">%ordering data (for manipulating nd-arrays)</span>
0203         <a name="_sub16" href="#_subfunctions" class="code">function dataOut=orderData(obj,dataIn,type)</a>
0204             <span class="keyword">switch</span> type
0205                 <span class="keyword">case</span> <span class="string">'sampleIn'</span>
0206                     <span class="comment">%size of the input data</span>
0207                     obj.sizeNonSample=[size(dataIn,1),size(dataIn,2),size(dataIn,3)];
0208                     <span class="comment">%in the case of nd-array</span>
0209                     <span class="keyword">if</span> obj.sizeNonSample(3)&gt;1
0210                         dataOut=reshape(dataIn,[ obj.sizeNonSample(1)*obj.sizeNonSample(2),obj.sizeNonSample(3),1]);
0211                     <span class="keyword">else</span>
0212                         dataOut=dataIn;
0213                     <span class="keyword">end</span>
0214                 <span class="keyword">case</span> <span class="string">'sampleOut'</span>
0215                     <span class="keyword">if</span> obj.sizeNonSample(3)&gt;1
0216                         dataOut=reshape(dataIn,[ obj.sizeNonSample(1),obj.sizeNonSample(2),obj.sizeNonSample(3)]);
0217                     <span class="keyword">else</span>
0218                         dataOut=dataIn;
0219                     <span class="keyword">end</span>
0220                 <span class="keyword">case</span> <span class="string">'respOut'</span>
0221                     <span class="keyword">if</span> obj.sizeNonSample(3)&gt;1
0222                         dataOut=reshape(dataIn,[ obj.sizeNonSample(1),obj.sizeNonSample(2)]);
0223                     <span class="keyword">else</span>
0224                         dataOut=dataIn;
0225                     <span class="keyword">end</span>
0226                 <span class="keyword">case</span> <span class="string">'gradOut'</span>
0227                     <span class="keyword">if</span> obj.sizeNonSample(3)&gt;1
0228                         dataOut=reshape(dataIn,[ obj.sizeNonSample(1),obj.sizeNonSample(2),obj.sizeNonSample(3)]);
0229                     <span class="keyword">else</span>
0230                         dataOut=dataIn;
0231                     <span class="keyword">end</span>
0232             <span class="keyword">end</span>
0233         <span class="keyword">end</span>
0234         <span class="comment">%Normalization of the input data</span>
0235         <a name="_sub17" href="#_subfunctions" class="code">function dataOut=normInputData(obj,type,dataIn)</a>
0236             <span class="keyword">if</span> obj.confMeta.normOn
0237                 <span class="comment">%preparing data structures</span>
0238                 infoDataS=obj.norm.sampling;
0239                 infoDataR=obj.norm.resp;
0240                 <span class="comment">%for various situations</span>
0241                 <span class="keyword">switch</span> type
0242                     <span class="keyword">case</span> <span class="string">'initSamplePts'</span>
0243                         [obj.samplingN,infoDataS]=<a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>(obj.sampling,<span class="string">'norm'</span>);
0244                         obj.normMeanS=infoDataS.mean;
0245                         obj.normStdS=infoDataS.std;
0246                         obj.normSamplePtsIn=true;
0247                     <span class="keyword">case</span> <span class="string">'initResp'</span>
0248                         [obj.respN,infoDataR]=<a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>(obj.resp,<span class="string">'norm'</span>);
0249                         obj.normMeanR=infoDataR.mean;
0250                         obj.normStdR=infoDataR.std;
0251                         obj.normRespIn=true;
0252                     <span class="keyword">case</span> <span class="string">'SamplePts'</span>
0253                         dataOut=<a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>(dataIn,<span class="string">'norm'</span>,infoDataS);
0254                     <span class="keyword">case</span> <span class="string">'Resp'</span>
0255                         dataOut=<a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>(dataIn,<span class="string">'norm'</span>,infoDataR);
0256                     <span class="keyword">case</span> <span class="string">'Grad'</span>
0257                         <span class="keyword">if</span> ~isempty(dataIn)
0258                             dataOut=<a href="../GRENAT/src/various/NormRenormG.html" class="code" title="function [out]=NormRenormG(in,type,infoDataS,infoDataR)">NormRenormG</a>(dataIn,<span class="string">'norm'</span>,infoDataS,infoDataR);
0259                         <span class="keyword">else</span>
0260                             dataOut=[];
0261                         <span class="keyword">end</span>
0262                 <span class="keyword">end</span>
0263             <span class="keyword">else</span>
0264                 <span class="keyword">if</span> nargout&gt;2
0265                     dataOut=dataIn;
0266                 <span class="keyword">end</span>
0267             <span class="keyword">end</span>
0268         <span class="keyword">end</span>
0269         <span class="comment">%ReNormalization of the input data</span>
0270         <a name="_sub18" href="#_subfunctions" class="code">function dataOut=reNormInputData(obj,type,dataIn)</a>
0271             <span class="keyword">if</span> obj.confMeta.normOn
0272                 <span class="comment">%preparing data structures</span>
0273                 infoDataS=obj.norm.sampling;
0274                 infoDataR=obj.norm.resp;
0275                 <span class="comment">%for various situations</span>
0276                 <span class="keyword">switch</span> type
0277                     <span class="keyword">case</span> <span class="string">'SamplePts'</span>
0278                         dataOut=<a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>(dataIn,<span class="string">'renorm'</span>,infoDataS);
0279                     <span class="keyword">case</span> <span class="string">'Resp'</span>
0280                         dataOut=<a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>(dataIn,<span class="string">'renorm'</span>,infoDataR);
0281                     <span class="keyword">case</span> <span class="string">'Grad'</span>
0282                         dataOut=<a href="../GRENAT/src/various/NormRenormG.html" class="code" title="function [out]=NormRenormG(in,type,infoDataS,infoDataR)">NormRenormG</a>(dataIn,<span class="string">'renorm'</span>,infoDataS,infoDataR);
0283                 <span class="keyword">end</span>
0284             <span class="keyword">else</span>
0285                 <span class="keyword">if</span> nargout&gt;2
0286                     dataOut=dataIn;
0287                 <span class="keyword">end</span>
0288             <span class="keyword">end</span>
0289         <span class="keyword">end</span>
0290         <span class="comment">%reset normalisation state</span>
0291         <a name="_sub19" href="#_subfunctions" class="code">function resetNorm(obj)</a>
0292             obj.normSamplePtsIn=false;
0293             obj.normRespIn=false;
0294         <span class="keyword">end</span>
0295         <span class="comment">%check missing data</span>
0296         <a name="_sub20" href="#_subfunctions" class="code">function checkMissingData(obj)</a>
0297             <span class="comment">%Check input data (find missing data)</span>
0298             obj.confMeta.miss=<a href="../GRENAT/src/various/CheckInputData.html" class="code" title="function [ret]=CheckInputData(sampling,resp,grad)">CheckInputData</a>(obj.samplingN,obj.respN,obj.gradN);
0299             obj.runMissingData=false;
0300         <span class="keyword">end</span>
0301         <span class="comment">%define the configuration for the display</span>
0302         <a name="_sub21" href="#_subfunctions" class="code">function defineDisp(obj,varargin)</a>
0303             <span class="comment">% look up the previous value</span>
0304             obj.confDisp.conf(varargin{:});
0305         <span class="keyword">end</span>
0306         <span class="comment">%train the metamodel</span>
0307         <a name="_sub22" href="#_subfunctions" class="code">function train(obj)</a>
0308             <span class="comment">%normalization of the input data</span>
0309             <a href="#_sub18" class="code" title="subfunction dataOut=normInputData(obj,type,dataIn)">normInputData</a>(obj,<span class="string">'initSamplePts'</span>);
0310             <a href="#_sub18" class="code" title="subfunction dataOut=normInputData(obj,type,dataIn)">normInputData</a>(obj,<span class="string">'initResp'</span>);
0311             obj.gradN=<a href="#_sub18" class="code" title="subfunction dataOut=normInputData(obj,type,dataIn)">normInputData</a>(obj,<span class="string">'Grad'</span>,obj.grad);
0312             <span class="comment">%check if data are missing</span>
0313             <a href="#_sub21" class="code" title="subfunction checkMissingData(obj)">checkMissingData</a>(obj);
0314             <span class="comment">%store normalization data</span>
0315             obj.confMeta.norm=obj.norm;
0316             <span class="comment">%train surrogate model</span>
0317             obj.dataTrain=<a href="../GRENAT/src/surrogate/BuildMeta.html" class="code" title="function [outMeta]=BuildMeta(samplingIn,respIn,gradIn,metaData)">BuildMeta</a>(obj.samplingN,obj.respN,obj.gradN,obj.confMeta);
0318             obj.runTrain=false;
0319             obj.runErr=true;
0320             
0321             <span class="comment">% keyboard</span>
0322             <span class="comment">% if metaData.norm.on&amp;&amp;~isempty(metaData.norm.resp.std)</span>
0323             <span class="comment">%     ret.build.sig2=ret.build.sig2*metaData.norm.resp.std^2;</span>
0324             <span class="comment">% end</span>
0325         <span class="keyword">end</span>
0326         <span class="comment">%evaluate the metamodel</span>
0327         <a name="_sub23" href="#_subfunctions" class="code">function [Z,GZ,variance]=eval(obj,nonsamplePts)</a>
0328             <span class="comment">%check if the metamodel has been already trained</span>
0329             <span class="keyword">if</span> obj.runTrain;<a href="#_sub23" class="code" title="subfunction train(obj)">train</a>(obj);<span class="keyword">end</span>
0330             <span class="comment">%store non sample points</span>
0331             <span class="keyword">if</span> nargin&gt;1;obj.nonsamplePts=nonsamplePts;<span class="keyword">end</span>
0332             <span class="comment">%evaluation of the metamodels</span>
0333             <span class="keyword">if</span> obj.runEval
0334                 <span class="comment">%normalization of the input data</span>
0335                 obj.nonsamplePtsN=<a href="#_sub18" class="code" title="subfunction dataOut=normInputData(obj,type,dataIn)">normInputData</a>(obj,<span class="string">'SamplePts'</span>,obj.nonsamplePtsOrder);
0336                 <span class="comment">%evaluation of the metamodel</span>
0337                 [K]=<a href="../GRENAT/src/surrogate/EvalMeta.html" class="code" title="function [Z]=EvalMeta(evalSample,dataTrain,metaConf,Verb)">EvalMeta</a>(obj.nonsamplePtsN,obj.dataTrain,obj.confMeta);
0338                 <span class="comment">%store data from the evaluation</span>
0339                 obj.nonsampleRespN=K.Z;
0340                 obj.nonsampleGradN=K.GZ;
0341                 obj.nonsampleVarOrder=K.var;
0342                 <span class="comment">%renormalization of the data</span>
0343                 obj.nonsampleRespOrder=<a href="#_sub19" class="code" title="subfunction dataOut=reNormInputData(obj,type,dataIn)">reNormInputData</a>(obj,<span class="string">'Resp'</span>,obj.nonsampleRespN);
0344                 obj.nonsampleGradOrder=<a href="#_sub19" class="code" title="subfunction dataOut=reNormInputData(obj,type,dataIn)">reNormInputData</a>(obj,<span class="string">'Grad'</span>,obj.nonsampleGradN);
0345                 <span class="comment">%update flags</span>
0346                 obj.runEval=false;
0347                 obj.runErr=true;
0348             <span class="keyword">end</span>
0349             <span class="comment">%extract unnormalized data</span>
0350             Z=obj.nonsampleResp;
0351             GZ=obj.nonsampleGrad;
0352             variance=obj.nonsampleVar;
0353         <span class="keyword">end</span>
0354         <span class="comment">%check interpolation</span>
0355         <a name="_sub24" href="#_subfunctions" class="code">function [ZI,detI]=evalInfill(obj,nonsamplePts)</a>
0356             <span class="comment">%store non sample points</span>
0357             <span class="keyword">if</span> nargin&gt;1;obj.nonsamplePts=nonsamplePts;<span class="keyword">end</span>
0358             <span class="comment">%evaluation</span>
0359             <a href="#_sub24" class="code" title="subfunction [Z,GZ,variance]=eval(obj,nonsamplePts)">eval</a>(obj);
0360             <span class="comment">%smallest response</span>
0361             respMin=min(obj.resp);
0362             <span class="comment">%computation of infill criteria</span>
0363             ZI=[];
0364             <span class="keyword">if</span> ~isempty(obj.nonsampleVar)
0365                 [ZI,detI]=<a href="../GRENAT/src/crit/InfillCrit.html" class="code" title="function [ZI,detInfill]=InfillCrit(respMin,Z,varZ,infillData)">InfillCrit</a>(respMin,obj.nonsampleResp,obj.nonsampleVar,obj.confMeta.infill);
0366             <span class="keyword">end</span>
0367         <span class="keyword">end</span>
0368         <span class="comment">%check interpolation</span>
0369         <a name="_sub25" href="#_subfunctions" class="code">function [statusR,statusG]=checkInterp(obj)</a>
0370             statusG=true;
0371             <span class="comment">%evaluation of the approximation at the sample points</span>
0372             [Z,GZ]=obj.eval(obj.sampling);
0373             <span class="comment">%check interpolation</span>
0374             statusR=<a href="../GRENAT/src/various/checkInterpRG.html" class="code" title="function statusI=checkInterpRG(ZRef,ZApp,type,critR,critG)">checkInterpRG</a>(obj.resp,Z,<span class="string">'resp'</span>);
0375             <span class="keyword">if</span>  obj.dataTrain.used.availGrad
0376                 statusG=<a href="../GRENAT/src/various/checkInterpRG.html" class="code" title="function statusI=checkInterpRG(ZRef,ZApp,type,critR,critG)">checkInterpRG</a>(obj.grad,GZ,<span class="string">'grad'</span>);
0377             <span class="keyword">end</span>
0378         <span class="keyword">end</span>
0379         <span class="comment">%evaluate the CI of the metamodel</span>
0380         <a name="_sub26" href="#_subfunctions" class="code">function [ci68,ci95,ci99]=evalCI(obj,nonsamplePts)</a>
0381             <span class="comment">%store non sample points</span>
0382             <span class="keyword">if</span> nargin&gt;1;obj.nonsamplePts=nonsamplePts;<span class="keyword">end</span>
0383             <span class="comment">%eval the CI</span>
0384             [ci68,ci95,ci99]=<a href="../GRENAT/src/crit/BuildCI.html" class="code" title="function [ci68,ci95,ci99]=BuildCI(ZZ,var)">BuildCI</a>(obj.nonsampleResp,obj.nonsampleVar);
0385             obj.nonsampleCI.ci68=ci68;
0386             obj.nonsampleCI.ci95=ci95;
0387             obj.nonsampleCI.ci99=ci99;
0388         <span class="keyword">end</span>
0389         <span class="comment">%extract CI</span>
0390         <a name="_sub27" href="#_subfunctions" class="code">function [ci68,ci95,ci99]=CI(obj,nonsamplePts)</a>
0391             <span class="comment">%store non sample points</span>
0392             <span class="keyword">if</span> nargin&gt;1;obj.nonsamplePts=nonsamplePts;<span class="keyword">end</span>
0393             <span class="comment">%eval the CI</span>
0394             [ci68,ci95,ci99]=<a href="../GRENAT/src/crit/BuildCI.html" class="code" title="function [ci68,ci95,ci99]=BuildCI(ZZ,var)">BuildCI</a>(obj.nonsampleResp,obj.nonsampleVar);
0395             obj.nonsampleCI.ci68=ci68;
0396             obj.nonsampleCI.ci95=ci95;
0397             obj.nonsampleCI.ci99=ci99;
0398         <span class="keyword">end</span>
0399         <span class="comment">%compute and show the errors of the metamodel (using reference if it is</span>
0400         <span class="comment">%available)</span>
0401         <a name="_sub28" href="#_subfunctions" class="code">function errCalc(obj)</a>
0402             obj.err=<a href="../GRENAT/src/crit/critErrDisp.html" class="code" title="function [err,errV,errNAME]=critErrDisp(Zap,Zref,data)">critErrDisp</a>(obj.nonsampleResp,obj.respRef,obj.dataTrain.build);
0403             obj.runErr=false;
0404         <span class="keyword">end</span>
0405         <span class="comment">%define the reference surface</span>
0406         <a name="_sub29" href="#_subfunctions" class="code">function defineRef(obj,varargin)</a>
0407             <span class="comment">%accepted keyword</span>
0408             keyOk={<span class="string">'sampleRef'</span>,<span class="string">'respRef'</span>,<span class="string">'gradRef'</span>};
0409             <span class="comment">%two kind of input variables list (with keywords or not)</span>
0410             <span class="comment">%depend on the first argument: double for classical list of</span>
0411             <span class="comment">%argument or string if the use of keywords</span>
0412             execOk=true;
0413             <span class="keyword">if</span> isa(varargin{1},<span class="string">'double'</span>)
0414                 <span class="keyword">if</span> nargin&gt;1;obj.sampleRef=varargin{1};obj.nonsamplePts=varargin{1};<span class="keyword">end</span>
0415                 <span class="keyword">if</span> nargin&gt;2;obj.respRef=varargin{2};<span class="keyword">end</span>
0416                 <span class="keyword">if</span> nargin&gt;3;obj.gradRef=varargin{3};<span class="keyword">end</span>
0417             <span class="keyword">elseif</span> isa(varargin{1},<span class="string">'char'</span>)
0418                 <span class="keyword">if</span> mod(nargin-1,2)==0
0419                     <span class="keyword">for</span> itV=1:2:nargin-1
0420                         <span class="comment">%load key and associated value</span>
0421                         keyTxt=varargin{itV};
0422                         keyVal=varargin{itV+1};
0423                         <span class="comment">%check if the keyword is usable</span>
0424                         <span class="keyword">if</span> ismember(keyTxt,keyOk)
0425                             <span class="comment">%store the data</span>
0426                             obj.(keyTxt)=keyVal;
0427                         <span class="keyword">else</span>
0428                             execOk=false;
0429                         <span class="keyword">end</span>
0430                     <span class="keyword">end</span>
0431                 <span class="keyword">else</span>
0432                     execOk=false;
0433                 <span class="keyword">end</span>
0434             <span class="keyword">else</span>
0435                 execOk=false;
0436             <span class="keyword">end</span>
0437             <span class="comment">%display error message if wrong syntax</span>
0438             <span class="keyword">if</span> ~execOk
0439                 fprintf(<span class="string">'Wrong syntax for the method\n'</span>)
0440                 fprintf(<span class="string">'defineref(sampleRef,respRef,gradRef)\n'</span>)
0441                 fprintf(<span class="string">'or defineref(''sampleRef'',val1,''respRef'',val2,''gradRef'',val3)\n'</span>)
0442             <span class="keyword">end</span>
0443         <span class="keyword">end</span>
0444         <span class="comment">%check if all data is available for displaying the reference</span>
0445         <span class="comment">%surface and gradients</span>
0446         <a name="_sub30" href="#_subfunctions" class="code">function [okAll,okSample,okResp,okGrad]=checkRef(obj)</a>
0447             okSample=false;
0448             okResp=false;
0449             okGrad=false;
0450             nbSRef(1)=size(obj.sampleRef,1);
0451             nbSRef(2)=size(obj.sampleRef,2);
0452             nbSRef(3)=size(obj.sampleRef,3);
0453             nbRRef(1)=size(obj.respRef,1);
0454             nbRRef(2)=size(obj.respRef,2);
0455             nbRRef(3)=size(obj.respRef,3);
0456             nbGRef(1)=size(obj.gradRef,1);
0457             nbGRef(2)=size(obj.gradRef,2);
0458             nbGRef(3)=size(obj.gradRef,3);
0459             <span class="keyword">if</span> sum(nbSRef(:))~=0
0460                 okSample=true;
0461                 <span class="keyword">if</span> nbSRef(1)==nbRRef(1)
0462                     okResp=true;
0463                 <span class="keyword">end</span>
0464                 <span class="keyword">if</span> nbGRef(3)==1
0465                     <span class="keyword">if</span> nbGRef(1)==nbSRef(1)&amp;&amp;nbGRef(2)==nbSRef(2)
0466                         okGrad=true;
0467                     <span class="keyword">end</span>
0468                 <span class="keyword">elseif</span> nbGRef(3)==nbSRef(2)&amp;&amp;nbGRef(1)==nbSRef(1)
0469                     okGrad=true;
0470                 <span class="keyword">elseif</span> all(nbGRef==nbSRef)
0471                     okGrad=true;
0472                 <span class="keyword">end</span>
0473             <span class="keyword">end</span>
0474             okAll=okSample&amp;&amp;okResp&amp;&amp;okGrad;
0475             <span class="comment">%display error messages</span>
0476             <span class="keyword">if</span> ~okSample;fprintf(<span class="string">'&gt;&gt; Wrong definition of the reference sample points\n'</span>);<span class="keyword">end</span>
0477             <span class="keyword">if</span> ~okResp;fprintf(<span class="string">'&gt;&gt; Wrong definition of the reference responses\n'</span>);<span class="keyword">end</span>
0478             <span class="keyword">if</span> ~okGrad;fprintf(<span class="string">'&gt;&gt; Wrong definition of the reference gradients\n'</span>);<span class="keyword">end</span>
0479         <span class="keyword">end</span>
0480         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0481         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0482         <span class="comment">%define properties</span>
0483         <a name="_sub31" href="#_subfunctions" class="code">function conf(obj,varargin)</a>
0484             <span class="comment">%list properties</span>
0485             listProp=properties(obj);
0486             okConf=false;
0487             <span class="comment">%if a input variable is specifiec</span>
0488             <span class="keyword">if</span> nargin&gt;2
0489                 <span class="comment">%if the number of input argument is even</span>
0490                 <span class="keyword">if</span>  mod(nargin-1,2)==0
0491                     <span class="comment">%along the argument</span>
0492                     <span class="keyword">for</span> itV=1:2:nargin-1
0493                         <span class="comment">%extract keyword and associated value</span>
0494                         keyW=varargin{itV};
0495                         keyV=varargin{itV+1};
0496                         <span class="comment">%if the first argument is a string</span>
0497                         <span class="keyword">if</span> isa(varargin{1},<span class="string">'char'</span>)
0498                             <span class="comment">%check if the keyword is acceptable</span>
0499                             <span class="keyword">if</span> ismember(keyW,listProp)
0500                                 okConf=true;
0501                                 obj.(keyW)=keyV;
0502                             <span class="keyword">else</span>
0503                                 fprintf(<span class="string">'&gt;&gt; Wrong keyword ''%s''\n'</span>,keyW);
0504                             <span class="keyword">end</span>
0505                         <span class="keyword">end</span>
0506                     <span class="keyword">end</span>
0507                 <span class="keyword">end</span>
0508                 <span class="keyword">if</span> ~okConf
0509                     fprintf(<span class="string">'\nWrong syntax used for conf method\n'</span>)
0510                     fprintf(<span class="string">'use: conf(''key1'',val1,''key2'',val2...)\n'</span>)
0511                     fprintf(<span class="string">'\nList of the available keywords:\n'</span>);
0512                     <a href="#_sub43" class="code" title="subfunction dispTableTwoColumnsStruct(tableFiedIn,structIn)">dispTableTwoColumnsStruct</a>(listProp,obj.infoProp);
0513                 <span class="keyword">end</span>
0514             <span class="keyword">else</span>
0515                 fprintf(<span class="string">'Current configuration\n'</span>);
0516                 disp(obj);
0517             <span class="keyword">end</span>
0518         <span class="keyword">end</span>
0519         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0520         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0521         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0522         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0523         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0524         <span class="comment">%display the surrogate model</span>
0525         <a name="_sub32" href="#_subfunctions" class="code">function show(obj,varargin)</a>
0526             <span class="comment">%depending of the kind of data</span>
0527             <span class="keyword">if</span> obj.sizeNonSample(3)==2
0528                 obj.confDisp.conf(<span class="string">'d3'</span>,true,<span class="string">'contour'</span>,true);
0529                 <span class="comment">%if argument</span>
0530                 <span class="keyword">if</span> nargin&gt;1;obj.confDisp.conf(varargin{:});<span class="keyword">end</span>
0531                 <a href="#_sub35" class="code" title="subfunction show2D(obj)">show2D</a>(obj);
0532             <span class="keyword">elseif</span> obj.sizeNonSample(3)==1
0533                 obj.confDisp.conf(<span class="string">'d3'</span>,false,<span class="string">'d2'</span>,false);
0534                 <span class="comment">%if argument</span>
0535                 <span class="keyword">if</span> nargin&gt;1;obj.confDisp.conf(varargin{:});<span class="keyword">end</span>
0536                 <a href="#_sub34" class="code" title="subfunction show1D(obj)">show1D</a>(obj);
0537             <span class="keyword">end</span>
0538         <span class="keyword">end</span>
0539         <a name="_sub33" href="#_subfunctions" class="code">function show1D(obj)</a>
0540             figure;
0541             <span class="comment">%depend if the reference is available or not</span>
0542             <span class="keyword">if</span> <a href="#_sub31" class="code" title="subfunction [okAll,okSample,okResp,okGrad]=checkRef(obj)">checkRef</a>(obj);
0543                 obj.nbSubplot=231;
0544                 subplot(obj.nbSubplot);
0545                 obj.confDisp.conf(<span class="string">'samplePts'</span>,true,<span class="string">'sampleGrad'</span>,false);
0546                 <a href="#_sub36" class="code" title="subfunction showRespRef(obj)">showRespRef</a>(obj);
0547                 obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot)
0548                 <span class="comment">%remove display of sample points</span>
0549                 obj.confDisp.conf(<span class="string">'samplePts'</span>,true,<span class="string">'sampleGrad'</span>,true);
0550                 <a href="#_sub37" class="code" title="subfunction showGradRef(obj,nbG)">showGradRef</a>(obj);
0551                 obj.nbSubplot=obj.nbSubplot+1;
0552             <span class="keyword">else</span>
0553                 obj.nbSubplot=221;
0554             <span class="keyword">end</span>
0555             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0556             obj.confDisp.conf(<span class="string">'samplePts'</span>,true,<span class="string">'sampleGrad'</span>,false);
0557             <a href="#_sub38" class="code" title="subfunction showResp(obj)">showResp</a>(obj);
0558             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0559             <span class="comment">%remove display of sample points</span>
0560             obj.confDisp.conf(<span class="string">'samplePts'</span>,true,<span class="string">'sampleGrad'</span>,true);
0561             <a href="#_sub39" class="code" title="subfunction showGrad(obj,nbG)">showGrad</a>(obj);
0562             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0563             <a href="#_sub40" class="code" title="subfunction showCI(obj,ciVal,nonsamplePts)">showCI</a>(obj,[]);
0564         <span class="keyword">end</span>
0565         <a name="_sub34" href="#_subfunctions" class="code">function show2D(obj)</a>
0566             figure;
0567             <span class="comment">%depend if the reference is available or not</span>
0568             <span class="keyword">if</span> <a href="#_sub31" class="code" title="subfunction [okAll,okSample,okResp,okGrad]=checkRef(obj)">checkRef</a>(obj);
0569                 obj.nbSubplot=331;
0570                 subplot(obj.nbSubplot);
0571                 obj.confDisp.conf(<span class="string">'samplePts'</span>,true);
0572                 <a href="#_sub36" class="code" title="subfunction showRespRef(obj)">showRespRef</a>(obj);
0573                 obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot)
0574                 <span class="comment">%remove display of sample points</span>
0575                 obj.confDisp.conf(<span class="string">'samplePts'</span>,false,<span class="string">'sampleGrad'</span>,false);
0576                 <a href="#_sub37" class="code" title="subfunction showGradRef(obj,nbG)">showGradRef</a>(obj,1);
0577                 obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot)
0578                 <a href="#_sub37" class="code" title="subfunction showGradRef(obj,nbG)">showGradRef</a>(obj,2);
0579             <span class="keyword">else</span>
0580                 obj.nbSubplot=231;
0581             <span class="keyword">end</span>
0582             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0583             obj.confDisp.conf(<span class="string">'samplePts'</span>,true);
0584             <a href="#_sub38" class="code" title="subfunction showResp(obj)">showResp</a>(obj);
0585             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0586             <span class="comment">%remove display of sample points</span>
0587             obj.confDisp.conf(<span class="string">'samplePts'</span>,false,<span class="string">'sampleGrad'</span>,false,<span class="string">'gridGrad'</span>,false);
0588             <a href="#_sub39" class="code" title="subfunction showGrad(obj,nbG)">showGrad</a>(obj,1);
0589             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0590             <a href="#_sub39" class="code" title="subfunction showGrad(obj,nbG)">showGrad</a>(obj,2);
0591             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0592             <a href="#_sub40" class="code" title="subfunction showCI(obj,ciVal,nonsamplePts)">showCI</a>(obj,[]);
0593         <span class="keyword">end</span>
0594         <span class="comment">%display the reference surface</span>
0595         <a name="_sub35" href="#_subfunctions" class="code">function showRespRef(obj)</a>
0596             obj.confDisp.title=(<span class="string">'Reference'</span>);
0597             <a href="../GRENAT/src/disp/displaySurrogate.html" class="code" title="function figHandle=displaySurrogate(gridXY,Z,sampling,resp,grad,dispData)">displaySurrogate</a>(obj.sampleRef,obj.respRef,obj.sampling,obj.resp,obj.grad,obj.confDisp);
0598         <span class="keyword">end</span>
0599         <span class="comment">%display the reference gradients surface</span>
0600         <a name="_sub36" href="#_subfunctions" class="code">function showGradRef(obj,nbG)</a>
0601             <span class="comment">%default value</span>
0602             <span class="keyword">if</span> nargin==1;nbG=1;<span class="keyword">end</span>
0603             obj.confDisp.title=([<span class="string">'Gradients Reference /x'</span> num2str(nbG)]);
0604             <a href="../GRENAT/src/disp/displaySurrogate.html" class="code" title="function figHandle=displaySurrogate(gridXY,Z,sampling,resp,grad,dispData)">displaySurrogate</a>(obj.sampleRef,obj.gradRef(:,:,nbG),obj.sampling,obj.resp,obj.grad,obj.confDisp);
0605         <span class="keyword">end</span>
0606         <span class="comment">%display the response approximated by the metamodel</span>
0607         <a name="_sub37" href="#_subfunctions" class="code">function showResp(obj)</a>
0608             obj.confDisp.title=(<span class="string">'Approximated responses'</span>);
0609             <a href="../GRENAT/src/disp/displaySurrogate.html" class="code" title="function figHandle=displaySurrogate(gridXY,Z,sampling,resp,grad,dispData)">displaySurrogate</a>(obj.nonsamplePts,obj.nonsampleResp,obj.sampling,obj.resp,obj.grad,obj.confDisp);
0610         <span class="keyword">end</span>
0611         <span class="comment">%display the gradients approximated by the metamodel</span>
0612         <a name="_sub38" href="#_subfunctions" class="code">function showGrad(obj,nbG)</a>
0613             <span class="comment">%default value</span>
0614             <span class="keyword">if</span> nargin==1;nbG=1;<span class="keyword">end</span>
0615             obj.confDisp.title=([<span class="string">'Approximated gradients /x'</span> num2str(nbG)]);
0616             <a href="../GRENAT/src/disp/displaySurrogate.html" class="code" title="function figHandle=displaySurrogate(gridXY,Z,sampling,resp,grad,dispData)">displaySurrogate</a>(obj.nonsamplePts,obj.nonsampleGrad(:,:,nbG),obj.sampling,obj.resp,obj.grad,obj.confDisp);
0617         <span class="keyword">end</span>
0618         <span class="comment">%display the confidence intervals approximated by the metamodel</span>
0619         <a name="_sub39" href="#_subfunctions" class="code">function showCI(obj,ciVal,nonsamplePts)</a>
0620             <span class="comment">%type of confidence intervals</span>
0621             ciOk=false;ciValDef=95;
0622             <span class="keyword">if</span> nargin&gt;1;<span class="keyword">if</span> ~isempty(ciVal);<span class="keyword">if</span> ismember(ciVal,[68,95,99]);ciOk=true;<span class="keyword">end</span>, <span class="keyword">end</span>, <span class="keyword">end</span>
0623             <span class="keyword">if</span> ~ciOk;ciVal=ciValDef;<span class="keyword">end</span>
0624             <span class="comment">%store non sample points</span>
0625             <span class="keyword">if</span> nargin&gt;2;obj.nonsamplePts=nonsamplePts;<span class="keyword">end</span>
0626             obj.confDisp.title=([num2str(ciVal) <span class="string">'% confidence intervals'</span>]);
0627             <span class="comment">%evaluation of the confidence interval</span>
0628             <a href="#_sub27" class="code" title="subfunction [ci68,ci95,ci99]=evalCI(obj,nonsamplePts)">evalCI</a>(obj);
0629             <span class="comment">%load data to display</span>
0630             ciDisp=obj.nonsampleCI.([<span class="string">'ci'</span> num2str(ciVal)]);
0631             <span class="comment">%display the CI</span>
0632             <a href="../GRENAT/src/disp/displaySurrogateCI.html" class="code" title="function displaySurrogateCI(Xpts,ic,dispData,Z)">displaySurrogateCI</a>(obj.nonsamplePts,ciDisp,obj.confDisp,obj.nonsampleResp);
0633         <span class="keyword">end</span>
0634         <span class="comment">%overload isfield</span>
0635         <a name="_sub40" href="#_subfunctions" class="code">function isF=isfield(obj,field)</a>
0636             isF=isprop(obj,field);
0637         <span class="keyword">end</span>
0638     <span class="keyword">end</span>
0639 <span class="keyword">end</span>
0640 
0641 
0642 
0643 
0644 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0645 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0646 <span class="comment">%function for declaring the purpose of each properties</span>
0647 <a name="_sub41" href="#_subfunctions" class="code">function info=affectTxtProp()</a>
0648 info.type=<span class="string">'Type of the surrogate model'</span>;
0649 info.sampling=<span class="string">'Coordinates of the sample points'</span>;
0650 info.resp=<span class="string">'Value(s) of the responses at the sample points'</span>;
0651 info.grad=<span class="string">'Value(s) of the gradients at the sample points'</span>;
0652 info.samplingN=<span class="string">'Normalized coordinates of the sample points'</span>;
0653 info.respN=<span class="string">'Value(s) of the normalized responses at the sample points'</span>;
0654 info.gradN=<span class="string">'Value(s) of the normalized gradients at the sample points'</span>;
0655 info.nonsamplePts=<span class="string">'Coordinates of the non-sample points'</span>;
0656 info.nonsampleResp=<span class="string">'Value(s) of the approximated responses calculated at the non-sample points'</span>;
0657 info.nonsampleGrad=<span class="string">'Value(s) of the approximated gradients calculated at the non-sample points'</span>;
0658 info.nonsamplePtsN=<span class="string">'Normalized coordinates of the  non-sample points'</span>;
0659 info.nonsampleRespN=<span class="string">'Value(s) of the normalized approximated responses calculated at the non-sample points'</span>;
0660 info.nonsampleGradN=<span class="string">'Value(s) of the normalized approximated gradients calculated at the non-sample points'</span>;
0661 info.nonsampleVar=<span class="string">'Value(s) of the variance calculated at the non-sample points'</span>;
0662 info.nonsampleCI=<span class="string">'Structure containing the bounds of the confidence intervals (68%, 95%, 99%)'</span>;
0663 info.nonsampleEI=<span class="string">'Value(s) of the expected improvment calculated at the non-sample points'</span>;
0664 info.norm=<span class="string">'Structure containing the normalization data'</span>;
0665 info.normMeanS=<span class="string">'Mean value of the sample points (vector)'</span>;
0666 info.normStdS=<span class="string">'Standard deviation of the sample points (vector)'</span>;
0667 info.normMeanR=<span class="string">'Mean value of the responses'</span>;
0668 info.normStdR=<span class="string">'Standard deviation of the responses'</span>;
0669 info.err=<span class="string">'Structure containing the values of the error criteria'</span>;
0670 info.sampleRef=<span class="string">'Array of the sample points used for the reference response surface'</span>;
0671 info.respRef=<span class="string">'Array of the responses of the reference response surface'</span>;
0672 info.gradRef=<span class="string">'Array of the gradients of the reference response surface'</span>;
0673 info.confMeta=<span class="string">'Class object (initMeta) containing information about the configuration (metamodel) (conf method for modifying it)'</span>;
0674 info.dataTrain=<span class="string">'Structures containing data about the training of the surrogate model'</span>;
0675 info.confDisp=<span class="string">'Class object (initDisp) containing information about the display (conf method for modifying it)'</span>;
0676 info.miss=<span class="string">'Structure Containing information about the missing data'</span>;
0677 <span class="keyword">end</span>
0678 
0679 <span class="comment">%function display table with two columns of text</span>
0680 <a name="_sub42" href="#_subfunctions" class="code">function dispTableTwoColumnsStruct(tableFiedIn,structIn)</a>
0681 <span class="comment">%size of every components in tableA</span>
0682 sizeA=cellfun(@numel,tableFiedIn);
0683 maxA=max(sizeA);
0684 <span class="comment">%space after each component</span>
0685 spaceA=maxA-sizeA+3;
0686 spaceTxt=<span class="string">' '</span>;
0687 <span class="comment">%display table</span>
0688 <span class="keyword">for</span> itT=1:numel(tableFiedIn)
0689     <span class="keyword">if</span> <a href="#_sub41" class="code" title="subfunction isF=isfield(obj,field)">isfield</a>(structIn,tableFiedIn{itT})
0690         fprintf(<span class="string">'%s%s%s\n'</span>,tableFiedIn{itT},spaceTxt(ones(1,spaceA(itT))),structIn.(tableFiedIn{itT}));
0691     <span class="keyword">end</span>
0692 <span class="keyword">end</span>
0693 <span class="keyword">end</span>
0694 
0695 <span class="comment">%function display table with two columns of text</span>
0696 <a name="_sub43" href="#_subfunctions" class="code">function dispTableTwoColumns(tableA,tableB)</a>
0697 <span class="comment">%size of every components in tableA</span>
0698 sizeA=cellfun(@numel,tableA);
0699 maxA=max(sizeA);
0700 <span class="comment">%space after each component</span>
0701 spaceA=maxA-sizeA+3;
0702 spaceTxt=<span class="string">' '</span>;
0703 <span class="comment">%display table</span>
0704 <span class="keyword">for</span> itT=1:numel(tableA)    
0705         fprintf(<span class="string">'%s%s%s\n'</span>,tableA{itT},spaceTxt(ones(1,spaceA(itT))),tableB{itT});
0706 <span class="keyword">end</span>
0707 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 09-Sep-2016 20:02:21 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>