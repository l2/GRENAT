<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of GRENAT</title>
  <meta name="keywords" content="GRENAT">
  <meta name="description" content="% GRENAT class for manipulating gradient-enhanced metamodels">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html GRENAT -->
<h1>GRENAT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>% GRENAT class for manipulating gradient-enhanced metamodels</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">% GRENAT class for manipulating gradient-enhanced metamodels
 L. LAURENT -- 26/06/2016 -- luc.laurent@lecnam.net</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="GRENAT.html" class="code" title="">GRENAT</a>	% GRENAT class for manipulating gradient-enhanced metamodels</li><li><a href="initDirGRENAT.html" class="code" title="function foldersLoad=initDirGRENAT(pathcustom,other)">initDirGRENAT</a>	% Initialization of the directories (MATLAB's path)</li><li><a href="../GRENAT/src/crit/BuildCI.html" class="code" title="function [ci68,ci95,ci99]=BuildCI(ZZ,var)">BuildCI</a>	% function for building confidence intervals (CI)</li><li><a href="../GRENAT/src/crit/InfillCrit.html" class="code" title="function [ZI,detInfill]=InfillCrit(respMin,Z,varZ,infillData)">InfillCrit</a>	% Compute infill criteria EI/WEI/LCB</li><li><a href="../GRENAT/src/crit/critErrDisp.html" class="code" title="function [err,errV,errNAME]=critErrDisp(Zap,Zref,data)">critErrDisp</a>	% Compute error criteria and display</li><li><a href="../GRENAT/src/disp/dispDate.html" class="code" title="function dispDate(type)">dispDate</a>	% Display date and time</li><li><a href="../GRENAT/src/disp/displaySurrogate.html" class="code" title="function figHandle=displaySurrogate(gridXY,Z,sampling,resp,grad,dispData)">displaySurrogate</a>	% function for displaying response surfaces</li><li><a href="../GRENAT/src/disp/displaySurrogateCI.html" class="code" title="function displaySurrogateCI(Xpts,ic,dispData,Z)">displaySurrogateCI</a>	% Display confidence intervals</li><li><a href="../GRENAT/src/init/initDisp.html" class="code" title="">initDisp</a>	% Initialization of display variables</li><li><a href="../GRENAT/src/init/initMeta.html" class="code" title="">initMeta</a>	% Initialization of the surrogate model</li><li><a href="../GRENAT/src/surrogate/BuildMeta.html" class="code" title="function [outMeta]=BuildMeta(samplingIn,respIn,gradIn,metaData)">BuildMeta</a>	% function for building surrogate model</li><li><a href="../GRENAT/src/surrogate/EvalMeta.html" class="code" title="function [Z]=EvalMeta(evalSample,dataTrain,metaConf,Verb)">EvalMeta</a>	% Evaluation of the surrogate model</li><li><a href="../GRENAT/src/various/CheckInputData.html" class="code" title="function [ret]=CheckInputData(sampling,resp,grad)">CheckInputData</a>	% check input data for finding missing information</li><li><a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>	% Normalization and renormalization of the Data</li><li><a href="../GRENAT/src/various/NormRenormG.html" class="code" title="function [out]=NormRenormG(in,type,infoDataS,infoDataR)">NormRenormG</a>	% normalization and renormalization of the gradient data</li><li><a href="../GRENAT/src/various/checkInterpRG.html" class="code" title="function statusI=checkInterpRG(ZRef,ZApp,type,critR,critG)">checkInterpRG</a>	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="ExampleUse1D.html" class="code" title="">ExampleUse1D</a>	Example of use of GRENAT without the sampling toolbox</li><li><a href="ExampleUse2D.html" class="code" title="">ExampleUse2D</a>	% Example of use of GRENAT without the sampling toolbox</li><li><a href="ExampleUseDOE.html" class="code" title="">ExampleUseDOE</a>	% Example of use of the GRENAToolbox with the MultiDOE one</li><li><a href="GRENAT.html" class="code" title="">GRENAT</a>	% GRENAT class for manipulating gradient-enhanced metamodels</li><li><a href="README.html" class="code" title="">README</a>	</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function obj=GRENAT(typeIn,samplingIn,respIn,gradIn)</a></li><li><a href="#_sub2" class="code">function set.sampling(obj,samplingIn)</a></li><li><a href="#_sub3" class="code">function set.resp(obj,respIn)</a></li><li><a href="#_sub4" class="code">function set.grad(obj,gradIn)</a></li><li><a href="#_sub5" class="code">function set.nonsamplePts(obj,samplingIn)</a></li><li><a href="#_sub6" class="code">function type=get.type(obj)</a></li><li><a href="#_sub7" class="code">function PtS=get.nonsamplePtsOrder(obj)</a></li><li><a href="#_sub8" class="code">function Z=get.nonsampleResp(obj)</a></li><li><a href="#_sub9" class="code">function GZ=get.nonsampleGrad(obj)</a></li><li><a href="#_sub10" class="code">function variance=get.nonsampleVar(obj)</a></li><li><a href="#_sub11" class="code">function err=get.err(obj)</a></li><li><a href="#_sub12" class="code">function normStruct=get.norm(obj)</a></li><li><a href="#_sub13" class="code">function initRunTrain(obj,flag)</a></li><li><a href="#_sub14" class="code">function initGradAvail(obj,flag)</a></li><li><a href="#_sub15" class="code">function initRunEval(obj,flag)</a></li><li><a href="#_sub16" class="code">function dataOut=orderData(obj,dataIn,type)</a></li><li><a href="#_sub17" class="code">function dataOut=normInputData(obj,type,dataIn)</a></li><li><a href="#_sub18" class="code">function dataOut=reNormInputData(obj,type,dataIn)</a></li><li><a href="#_sub19" class="code">function resetNorm(obj)</a></li><li><a href="#_sub20" class="code">function checkMissingData(obj)</a></li><li><a href="#_sub21" class="code">function defineDisp(obj,varargin)</a></li><li><a href="#_sub22" class="code">function train(obj)</a></li><li><a href="#_sub23" class="code">function [Z,GZ,variance]=eval(obj,nonsamplePts)</a></li><li><a href="#_sub24" class="code">function [ZI,detI]=evalInfill(obj,nonsamplePts)</a></li><li><a href="#_sub25" class="code">function [statusR,statusG]=checkInterp(obj)</a></li><li><a href="#_sub26" class="code">function [ci68,ci95,ci99]=evalCI(obj,nonsamplePts)</a></li><li><a href="#_sub27" class="code">function [ci68,ci95,ci99]=CI(obj,nonsamplePts)</a></li><li><a href="#_sub28" class="code">function errCalc(obj)</a></li><li><a href="#_sub29" class="code">function defineRef(obj,varargin)</a></li><li><a href="#_sub30" class="code">function [okAll,okSample,okResp,okGrad]=checkRef(obj)</a></li><li><a href="#_sub31" class="code">function conf(obj,varargin)</a></li><li><a href="#_sub32" class="code">function show(obj,varargin)</a></li><li><a href="#_sub33" class="code">function show1D(obj)</a></li><li><a href="#_sub34" class="code">function show2D(obj)</a></li><li><a href="#_sub35" class="code">function showRespRef(obj)</a></li><li><a href="#_sub36" class="code">function showGradRef(obj,nbG)</a></li><li><a href="#_sub37" class="code">function showResp(obj)</a></li><li><a href="#_sub38" class="code">function showGrad(obj,nbG)</a></li><li><a href="#_sub39" class="code">function showCI(obj,ciVal,nonsamplePts)</a></li><li><a href="#_sub40" class="code">function isF=isfield(obj,field)</a></li><li><a href="#_sub41" class="code">function info=affectTxtProp()</a></li><li><a href="#_sub42" class="code">function dispTableTwoColumnsStruct(tableFiedIn,structIn)</a></li><li><a href="#_sub43" class="code">function dispTableTwoColumns(tableA,tableB)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%% GRENAT class for manipulating gradient-enhanced metamodels</span>
0002 <span class="comment">% L. LAURENT -- 26/06/2016 -- luc.laurent@lecnam.net</span>
0003 
0004 <span class="comment">%     GRENAT - GRadient ENhanced Approximation Toolbox</span>
0005 <span class="comment">%     A toolbox for generating and exploiting gradient-enhanced surrogate models</span>
0006 <span class="comment">%     Copyright (C) 2016  Luc LAURENT &lt;luc.laurent@lecnam.net&gt;</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%     This program is free software: you can redistribute it and/or modify</span>
0009 <span class="comment">%     it under the terms of the GNU General Public License as published by</span>
0010 <span class="comment">%     the Free Software Foundation, either version 3 of the License, or</span>
0011 <span class="comment">%     (at your option) any later version.</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%     This program is distributed in the hope that it will be useful,</span>
0014 <span class="comment">%     but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
0015 <span class="comment">%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
0016 <span class="comment">%     GNU General Public License for more details.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%     You should have received a copy of the GNU General Public License</span>
0019 <span class="comment">%     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
0020 
0021 classdef <a href="GRENAT.html" class="code" title="">GRENAT</a> &lt; handle
0022     
0023     properties
0024         <span class="comment">%building</span>
0025         sampling=[];
0026         resp=[];
0027         grad=[];
0028         samplingN=[];
0029         respN=[];
0030         gradN=[];
0031         <span class="comment">%evaluating</span>
0032         nonsamplePts=[];
0033         nonsampleResp=[];
0034         nonsampleGrad=[];
0035         nonsamplePtsOrder=[];
0036         nonsampleRespOrder=[];
0037         nonsampleGradOrder=[];
0038         nonsamplePtsN=[];
0039         nonsampleRespN=[];
0040         nonsampleGradN=[];
0041         sizeNonSample=zeros(1,3);
0042         nonsampleVar=[];
0043         nonsampleVarOrder=[];
0044         nonsampleCI=struct(<span class="string">'ci68'</span>,[],<span class="string">'ci95'</span>,[],<span class="string">'ci98'</span>,[]);
0045         nonsampleEI=[];
0046         <span class="comment">%normalization data</span>
0047         norm;
0048         normMeanS;
0049         normStdS;
0050         normMeanR;
0051         normStdR;
0052         <span class="comment">%</span>
0053         err=[];
0054         <span class="comment">%reference</span>
0055         sampleRef=[];
0056         respRef=[];
0057         gradRef=[];
0058         <span class="comment">%structures &amp; class for storing configuration and data</span>
0059         confMeta;   <span class="comment">%metamodel configuration</span>
0060         dataTrain;  <span class="comment">%training data</span>
0061         confDisp;   <span class="comment">%display configuration</span>
0062         miss;       <span class="comment">%missing data</span>
0063     <span class="keyword">end</span>
0064     properties (Dependent)
0065         type;
0066     <span class="keyword">end</span>
0067     
0068     properties (Access = private)
0069         runTrain=true; <span class="comment">%flag for checking if the training is obsolete</span>
0070         runEval=true; <span class="comment">%flag for checking if the training is obsolete</span>
0071         gradAvail=false; <span class="comment">%flag for availability of the gradients</span>
0072         runErr=true; <span class="comment">%flag for computation of the error</span>
0073         normSamplePtsIn=false; <span class="comment">%flag for checking if the input data are normalized</span>
0074         normRespIn=false; <span class="comment">%flag for checking if the input data are normalized</span>
0075         runMissingData=true; <span class="comment">%flag for checking missing data</span>
0076         nbSubplot=0; <span class="comment">%number of subplot for display</span>
0077     <span class="keyword">end</span>
0078     properties (Access = private,Constant)
0079         infoProp=<a href="#_sub41" class="code" title="subfunction info=affectTxtProp()">affectTxtProp</a>;
0080     <span class="keyword">end</span>
0081     
0082     methods
0083         <span class="comment">%construction</span>
0084         <a name="_sub0" href="#_subfunctions" class="code">function obj=GRENAT(typeIn,samplingIn,respIn,gradIn)</a>
0085             <span class="comment">%load directories on the path</span>
0086             <a href="initDirGRENAT.html" class="code" title="function foldersLoad=initDirGRENAT(pathcustom,other)">initDirGRENAT</a>;
0087             <span class="comment">%</span>
0088             fprintf(<span class="string">'=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=\n'</span>);
0089             fprintf(<span class="string">'=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=\n'</span>);
0090             fprintf(<span class="string">' Create GRENAT Object \n'</span>)
0091             <span class="comment">%the date and time</span>
0092             <a href="../GRENAT/src/disp/dispDate.html" class="code" title="function dispDate(type)">dispDate</a>;
0093             <span class="comment">%load default configuration</span>
0094             obj.confMeta=<a href="../GRENAT/src/init/initMeta.html" class="code" title="">initMeta</a>;
0095             <span class="comment">%load display configuration</span>
0096             obj.confDisp=<a href="../GRENAT/src/init/initDisp.html" class="code" title="">initDisp</a>;
0097             <span class="comment">%specific configuration</span>
0098             <span class="keyword">if</span> nargin&gt;0;obj.confMeta.type=typeIn;<span class="keyword">end</span>
0099             <span class="keyword">if</span> nargin&gt;1;obj.sampling=samplingIn;<span class="keyword">end</span>
0100             <span class="keyword">if</span> nargin&gt;2;obj.resp=respIn;<span class="keyword">end</span>
0101             <span class="keyword">if</span> nargin&gt;3;obj.grad=gradIn;<span class="keyword">end</span>
0102         <span class="keyword">end</span>
0103         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0104         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0105         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0106         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0107         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0108         <span class="comment">%setter for the sampling</span>
0109         <a name="_sub1" href="#_subfunctions" class="code">function set.sampling(obj,samplingIn)</a>
0110             <span class="keyword">if</span> ~isempty(samplingIn)
0111                 obj.sampling=samplingIn;
0112                 <a href="#_sub13" class="code" title="subfunction initRunTrain(obj,flag)">initRunTrain</a>(obj,true);
0113                 <a href="#_sub19" class="code" title="subfunction resetNorm(obj)">resetNorm</a>(obj);
0114             <span class="keyword">else</span>
0115                 fprintf(<span class="string">'ERROR: Empty array of sample points\n'</span>);
0116             <span class="keyword">end</span>
0117         <span class="keyword">end</span>
0118         <span class="comment">%setter for the responses</span>
0119         <a name="_sub2" href="#_subfunctions" class="code">function set.resp(obj,respIn)</a>
0120             <span class="keyword">if</span> ~isempty(respIn)
0121                 obj.resp=respIn;
0122                 <a href="#_sub13" class="code" title="subfunction initRunTrain(obj,flag)">initRunTrain</a>(obj,true);
0123             <span class="keyword">else</span>
0124                 fprintf(<span class="string">'ERROR: Empty array of responses\n'</span>);
0125             <span class="keyword">end</span>
0126         <span class="keyword">end</span>
0127         <span class="comment">%setter for the gradients</span>
0128         <a name="_sub3" href="#_subfunctions" class="code">function set.grad(obj,gradIn)</a>
0129             <span class="keyword">if</span> ~isempty(gradIn)
0130                 obj.grad=gradIn;
0131                 <a href="#_sub13" class="code" title="subfunction initRunTrain(obj,flag)">initRunTrain</a>(obj,true);
0132                 <a href="#_sub14" class="code" title="subfunction initGradAvail(obj,flag)">initGradAvail</a>(obj,true);
0133             <span class="keyword">end</span>
0134         <span class="keyword">end</span>
0135         <span class="comment">%setter for the non sample points</span>
0136         <a name="_sub4" href="#_subfunctions" class="code">function set.nonsamplePts(obj,samplingIn)</a>
0137             <span class="keyword">if</span> ~isempty(samplingIn)
0138                 obj.nonsamplePts=samplingIn;
0139                 <a href="#_sub15" class="code" title="subfunction initRunEval(obj,flag)">initRunEval</a>(obj,true);
0140             <span class="keyword">end</span>
0141         <span class="keyword">end</span>
0142         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0143         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0144         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0145         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0146         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0147         <span class="comment">%getter for the type of metamodel</span>
0148         <a name="_sub5" href="#_subfunctions" class="code">function type=get.type(obj)</a>
0149             type=obj.confMeta.type;
0150         <span class="keyword">end</span>
0151         <span class="comment">%setter for the non sample points</span>
0152         <a name="_sub6" href="#_subfunctions" class="code">function PtS=get.nonsamplePtsOrder(obj)</a>
0153             PtS=<a href="#_sub16" class="code" title="subfunction dataOut=orderData(obj,dataIn,type)">orderData</a>(obj,obj.nonsamplePts,<span class="string">'sampleIn'</span>);
0154         <span class="keyword">end</span>
0155         <span class="comment">%getter for the responses at the non sample points</span>
0156         <a name="_sub7" href="#_subfunctions" class="code">function Z=get.nonsampleResp(obj)</a>
0157             <span class="keyword">if</span> obj.runEval;<a href="#_sub23" class="code" title="subfunction [Z,GZ,variance]=eval(obj,nonsamplePts)">eval</a>(obj);<span class="keyword">end</span>
0158             Z=<a href="#_sub16" class="code" title="subfunction dataOut=orderData(obj,dataIn,type)">orderData</a>(obj,obj.nonsampleRespOrder,<span class="string">'respOut'</span>);
0159         <span class="keyword">end</span>
0160         <span class="comment">%getter for the gradients at the non sample points</span>
0161         <a name="_sub8" href="#_subfunctions" class="code">function GZ=get.nonsampleGrad(obj)</a>
0162             <span class="keyword">if</span> obj.runEval;<a href="#_sub23" class="code" title="subfunction [Z,GZ,variance]=eval(obj,nonsamplePts)">eval</a>(obj);<span class="keyword">end</span>
0163             GZ=<a href="#_sub16" class="code" title="subfunction dataOut=orderData(obj,dataIn,type)">orderData</a>(obj,obj.nonsampleGradOrder,<span class="string">'gradOut'</span>);
0164         <span class="keyword">end</span>
0165         <span class="comment">%getter for the variance at the non sample points</span>
0166         <a name="_sub9" href="#_subfunctions" class="code">function variance=get.nonsampleVar(obj)</a>
0167             <span class="keyword">if</span> obj.runEval;<a href="#_sub23" class="code" title="subfunction [Z,GZ,variance]=eval(obj,nonsamplePts)">eval</a>(obj);<span class="keyword">end</span>
0168             variance=<a href="#_sub16" class="code" title="subfunction dataOut=orderData(obj,dataIn,type)">orderData</a>(obj,obj.nonsampleVarOrder,<span class="string">'respOut'</span>);
0169         <span class="keyword">end</span>
0170         <span class="comment">%getter for error values</span>
0171         <a name="_sub10" href="#_subfunctions" class="code">function err=get.err(obj)</a>
0172             <span class="keyword">if</span> obj.runErr;<a href="#_sub28" class="code" title="subfunction errCalc(obj)">errCalc</a>(obj);<span class="keyword">end</span>
0173             err=obj.err;
0174         <span class="keyword">end</span>
0175         <span class="comment">%getter for normalization data structure</span>
0176         <a name="_sub11" href="#_subfunctions" class="code">function normStruct=get.norm(obj)</a>
0177             normStruct.sampling.mean=obj.normMeanS;
0178             normStruct.sampling.std=obj.normStdS;
0179             normStruct.resp.mean=obj.normMeanR;
0180             normStruct.resp.std=obj.normStdR;
0181             normStruct.on=obj.confMeta.normOn;
0182         <span class="keyword">end</span>
0183         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0184         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0185         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0186         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0187         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0188         <span class="comment">%initialize flags</span>
0189         <a name="_sub12" href="#_subfunctions" class="code">function initRunTrain(obj,flag)</a>
0190             obj.runTrain=flag;
0191         <span class="keyword">end</span>
0192         <a name="_sub13" href="#_subfunctions" class="code">function initGradAvail(obj,flag)</a>
0193             obj.gradAvail=flag;
0194         <span class="keyword">end</span>
0195         <a name="_sub14" href="#_subfunctions" class="code">function initRunEval(obj,flag)</a>
0196             obj.runEval=flag;
0197         <span class="keyword">end</span>
0198         <span class="comment">%ordering data (for manipulating nd-arrays)</span>
0199         <a name="_sub15" href="#_subfunctions" class="code">function dataOut=orderData(obj,dataIn,type)</a>
0200             <span class="keyword">switch</span> type
0201                 <span class="keyword">case</span> <span class="string">'sampleIn'</span>
0202                     <span class="comment">%size of the input data</span>
0203                     obj.sizeNonSample=[size(dataIn,1),size(dataIn,2),size(dataIn,3)];
0204                     <span class="comment">%in the case of nd-array</span>
0205                     <span class="keyword">if</span> obj.sizeNonSample(3)&gt;1
0206                         dataOut=reshape(dataIn,[ obj.sizeNonSample(1)*obj.sizeNonSample(2),obj.sizeNonSample(3),1]);
0207                     <span class="keyword">else</span>
0208                         dataOut=dataIn;
0209                     <span class="keyword">end</span>
0210                 <span class="keyword">case</span> <span class="string">'sampleOut'</span>
0211                     <span class="keyword">if</span> obj.sizeNonSample(3)&gt;1
0212                         dataOut=reshape(dataIn,[ obj.sizeNonSample(1),obj.sizeNonSample(2),obj.sizeNonSample(3)]);
0213                     <span class="keyword">else</span>
0214                         dataOut=dataIn;
0215                     <span class="keyword">end</span>
0216                 <span class="keyword">case</span> <span class="string">'respOut'</span>
0217                     <span class="keyword">if</span> obj.sizeNonSample(3)&gt;1
0218                         dataOut=reshape(dataIn,[ obj.sizeNonSample(1),obj.sizeNonSample(2)]);
0219                     <span class="keyword">else</span>
0220                         dataOut=dataIn;
0221                     <span class="keyword">end</span>
0222                 <span class="keyword">case</span> <span class="string">'gradOut'</span>
0223                     <span class="keyword">if</span> obj.sizeNonSample(3)&gt;1
0224                         dataOut=reshape(dataIn,[ obj.sizeNonSample(1),obj.sizeNonSample(2),obj.sizeNonSample(3)]);
0225                     <span class="keyword">else</span>
0226                         dataOut=dataIn;
0227                     <span class="keyword">end</span>
0228             <span class="keyword">end</span>
0229         <span class="keyword">end</span>
0230         <span class="comment">%Normalization of the input data</span>
0231         <a name="_sub16" href="#_subfunctions" class="code">function dataOut=normInputData(obj,type,dataIn)</a>
0232             <span class="keyword">if</span> obj.confMeta.normOn
0233                 <span class="comment">%preparing data structures</span>
0234                 infoDataS=obj.norm.sampling;
0235                 infoDataR=obj.norm.resp;
0236                 <span class="comment">%for various situations</span>
0237                 <span class="keyword">switch</span> type
0238                     <span class="keyword">case</span> <span class="string">'initSamplePts'</span>
0239                         [obj.samplingN,infoDataS]=<a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>(obj.sampling,<span class="string">'norm'</span>);
0240                         obj.normMeanS=infoDataS.mean;
0241                         obj.normStdS=infoDataS.std;
0242                         obj.normSamplePtsIn=true;
0243                     <span class="keyword">case</span> <span class="string">'initResp'</span>
0244                         [obj.respN,infoDataR]=<a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>(obj.resp,<span class="string">'norm'</span>);
0245                         obj.normMeanR=infoDataR.mean;
0246                         obj.normStdR=infoDataR.std;
0247                         obj.normRespIn=true;
0248                     <span class="keyword">case</span> <span class="string">'SamplePts'</span>
0249                         dataOut=<a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>(dataIn,<span class="string">'norm'</span>,infoDataS);
0250                     <span class="keyword">case</span> <span class="string">'Resp'</span>
0251                         dataOut=<a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>(dataIn,<span class="string">'norm'</span>,infoDataR);
0252                     <span class="keyword">case</span> <span class="string">'Grad'</span>
0253                         dataOut=<a href="../GRENAT/src/various/NormRenormG.html" class="code" title="function [out]=NormRenormG(in,type,infoDataS,infoDataR)">NormRenormG</a>(dataIn,<span class="string">'norm'</span>,infoDataS,infoDataR);
0254                 <span class="keyword">end</span>
0255             <span class="keyword">else</span>
0256                 <span class="keyword">if</span> nargout&gt;2
0257                     dataOut=dataIn;
0258                 <span class="keyword">end</span>
0259             <span class="keyword">end</span>
0260         <span class="keyword">end</span>
0261         <span class="comment">%ReNormalization of the input data</span>
0262         <a name="_sub17" href="#_subfunctions" class="code">function dataOut=reNormInputData(obj,type,dataIn)</a>
0263             <span class="keyword">if</span> obj.confMeta.normOn
0264                 <span class="comment">%preparing data structures</span>
0265                 infoDataS=obj.norm.sampling;
0266                 infoDataR=obj.norm.resp;
0267                 <span class="comment">%for various situations</span>
0268                 <span class="keyword">switch</span> type
0269                     <span class="keyword">case</span> <span class="string">'SamplePts'</span>
0270                         dataOut=<a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>(dataIn,<span class="string">'renorm'</span>,infoDataS);
0271                     <span class="keyword">case</span> <span class="string">'Resp'</span>
0272                         dataOut=<a href="../GRENAT/src/various/NormRenorm.html" class="code" title="function [out,infoData]=NormRenorm(in,type,infoData)">NormRenorm</a>(dataIn,<span class="string">'renorm'</span>,infoDataR);
0273                     <span class="keyword">case</span> <span class="string">'Grad'</span>
0274                         dataOut=<a href="../GRENAT/src/various/NormRenormG.html" class="code" title="function [out]=NormRenormG(in,type,infoDataS,infoDataR)">NormRenormG</a>(dataIn,<span class="string">'renorm'</span>,infoDataS,infoDataR);
0275                 <span class="keyword">end</span>
0276             <span class="keyword">else</span>
0277                 <span class="keyword">if</span> nargout&gt;2
0278                     dataOut=dataIn;
0279                 <span class="keyword">end</span>
0280             <span class="keyword">end</span>
0281         <span class="keyword">end</span>
0282         <span class="comment">%reset normalisation state</span>
0283         <a name="_sub18" href="#_subfunctions" class="code">function resetNorm(obj)</a>
0284             obj.normSamplePtsIn=false;
0285             obj.normRespIn=false;
0286         <span class="keyword">end</span>
0287         <span class="comment">%check missing data</span>
0288         <a name="_sub19" href="#_subfunctions" class="code">function checkMissingData(obj)</a>
0289             <span class="comment">%Check input data (find missing data)</span>
0290             obj.confMeta.miss=<a href="../GRENAT/src/various/CheckInputData.html" class="code" title="function [ret]=CheckInputData(sampling,resp,grad)">CheckInputData</a>(obj.samplingN,obj.respN,obj.gradN);
0291             obj.runMissingData=false;
0292         <span class="keyword">end</span>
0293         <span class="comment">%define the configuration for the display</span>
0294         <a name="_sub20" href="#_subfunctions" class="code">function defineDisp(obj,varargin)</a>
0295             <span class="comment">% look up the previous value</span>
0296             obj.confDisp.conf(varargin{:});
0297         <span class="keyword">end</span>
0298         <span class="comment">%train the metamodel</span>
0299         <a name="_sub21" href="#_subfunctions" class="code">function train(obj)</a>
0300             <span class="comment">%normalization of the input data</span>
0301             <a href="#_sub17" class="code" title="subfunction dataOut=normInputData(obj,type,dataIn)">normInputData</a>(obj,<span class="string">'initSamplePts'</span>);
0302             <a href="#_sub17" class="code" title="subfunction dataOut=normInputData(obj,type,dataIn)">normInputData</a>(obj,<span class="string">'initResp'</span>);
0303             obj.gradN=<a href="#_sub17" class="code" title="subfunction dataOut=normInputData(obj,type,dataIn)">normInputData</a>(obj,<span class="string">'Grad'</span>,obj.grad);
0304             <span class="comment">%check if data are missing</span>
0305             <a href="#_sub20" class="code" title="subfunction checkMissingData(obj)">checkMissingData</a>(obj);
0306             <span class="comment">%store normalization data</span>
0307             obj.confMeta.norm=obj.norm;
0308             <span class="comment">%train surrogate model</span>
0309             obj.dataTrain=<a href="../GRENAT/src/surrogate/BuildMeta.html" class="code" title="function [outMeta]=BuildMeta(samplingIn,respIn,gradIn,metaData)">BuildMeta</a>(obj.samplingN,obj.respN,obj.gradN,obj.confMeta);
0310             obj.runTrain=false;
0311             obj.runErr=true;
0312             
0313             <span class="comment">% keyboard</span>
0314             <span class="comment">% if metaData.norm.on&amp;&amp;~isempty(metaData.norm.resp.std)</span>
0315             <span class="comment">%     ret.build.sig2=ret.build.sig2*metaData.norm.resp.std^2;</span>
0316             <span class="comment">% end</span>
0317         <span class="keyword">end</span>
0318         <span class="comment">%evaluate the metamodel</span>
0319         <a name="_sub22" href="#_subfunctions" class="code">function [Z,GZ,variance]=eval(obj,nonsamplePts)</a>
0320             <span class="comment">%check if the metamodel has been already trained</span>
0321             <span class="keyword">if</span> obj.runTrain;<a href="#_sub22" class="code" title="subfunction train(obj)">train</a>(obj);<span class="keyword">end</span>
0322             <span class="comment">%store non sample points</span>
0323             <span class="keyword">if</span> nargin&gt;1;obj.nonsamplePts=nonsamplePts;<span class="keyword">end</span>
0324             <span class="comment">%evaluation of the metamodels</span>
0325             <span class="keyword">if</span> obj.runEval
0326                 <span class="comment">%normalization of the input data</span>
0327                 obj.nonsamplePtsN=<a href="#_sub17" class="code" title="subfunction dataOut=normInputData(obj,type,dataIn)">normInputData</a>(obj,<span class="string">'SamplePts'</span>,obj.nonsamplePtsOrder);
0328                 <span class="comment">%evaluation of the metamodel</span>
0329                 [K]=<a href="../GRENAT/src/surrogate/EvalMeta.html" class="code" title="function [Z]=EvalMeta(evalSample,dataTrain,metaConf,Verb)">EvalMeta</a>(obj.nonsamplePtsN,obj.dataTrain,obj.confMeta);
0330                 <span class="comment">%store data from the evaluation</span>
0331                 obj.nonsampleRespN=K.Z;
0332                 obj.nonsampleGradN=K.GZ;
0333                 obj.nonsampleVarOrder=K.var;
0334                 <span class="comment">%renormalization of the data</span>
0335                 obj.nonsampleRespOrder=<a href="#_sub18" class="code" title="subfunction dataOut=reNormInputData(obj,type,dataIn)">reNormInputData</a>(obj,<span class="string">'Resp'</span>,obj.nonsampleRespN);
0336                 obj.nonsampleGradOrder=<a href="#_sub18" class="code" title="subfunction dataOut=reNormInputData(obj,type,dataIn)">reNormInputData</a>(obj,<span class="string">'Grad'</span>,obj.nonsampleGradN);
0337                 <span class="comment">%update flags</span>
0338                 obj.runEval=false;
0339                 obj.runErr=true;
0340             <span class="keyword">end</span>
0341             <span class="comment">%extract unnormalized data</span>
0342             Z=obj.nonsampleResp;
0343             GZ=obj.nonsampleGrad;
0344             variance=obj.nonsampleVar;
0345         <span class="keyword">end</span>
0346         <span class="comment">%check interpolation</span>
0347         <a name="_sub23" href="#_subfunctions" class="code">function [ZI,detI]=evalInfill(obj,nonsamplePts)</a>
0348             <span class="comment">%store non sample points</span>
0349             <span class="keyword">if</span> nargin&gt;1;obj.nonsamplePts=nonsamplePts;<span class="keyword">end</span>
0350             <span class="comment">%evaluation</span>
0351             <a href="#_sub23" class="code" title="subfunction [Z,GZ,variance]=eval(obj,nonsamplePts)">eval</a>(obj);
0352             <span class="comment">%smallest response</span>
0353             respMin=min(obj.resp);
0354             <span class="comment">%computation of infill criteria</span>
0355             ZI=[];
0356             <span class="keyword">if</span> ~isempty(obj.nonsampleVar)
0357                 [ZI,detI]=<a href="../GRENAT/src/crit/InfillCrit.html" class="code" title="function [ZI,detInfill]=InfillCrit(respMin,Z,varZ,infillData)">InfillCrit</a>(respMin,obj.nonsampleResp,obj.nonsampleVar,obj.confMeta.infill);
0358             <span class="keyword">end</span>
0359         <span class="keyword">end</span>
0360         <span class="comment">%check interpolation</span>
0361         <a name="_sub24" href="#_subfunctions" class="code">function [statusR,statusG]=checkInterp(obj)</a>
0362             statusG=true;
0363             <span class="comment">%evaluation of the approximation at the sample points</span>
0364             [Z,GZ]=obj.eval(obj.sampling);
0365             <span class="comment">%check interpolation</span>
0366             statusR=<a href="../GRENAT/src/various/checkInterpRG.html" class="code" title="function statusI=checkInterpRG(ZRef,ZApp,type,critR,critG)">checkInterpRG</a>(obj.resp,Z,<span class="string">'resp'</span>);
0367             <span class="keyword">if</span>  obj.dataTrain.used.availGrad
0368                 statusG=<a href="../GRENAT/src/various/checkInterpRG.html" class="code" title="function statusI=checkInterpRG(ZRef,ZApp,type,critR,critG)">checkInterpRG</a>(obj.grad,GZ,<span class="string">'grad'</span>);
0369             <span class="keyword">end</span>
0370         <span class="keyword">end</span>
0371         <span class="comment">%evaluate the CI of the metamodel</span>
0372         <a name="_sub25" href="#_subfunctions" class="code">function [ci68,ci95,ci99]=evalCI(obj,nonsamplePts)</a>
0373             <span class="comment">%store non sample points</span>
0374             <span class="keyword">if</span> nargin&gt;1;obj.nonsamplePts=nonsamplePts;<span class="keyword">end</span>
0375             <span class="comment">%eval the CI</span>
0376             [ci68,ci95,ci99]=<a href="../GRENAT/src/crit/BuildCI.html" class="code" title="function [ci68,ci95,ci99]=BuildCI(ZZ,var)">BuildCI</a>(obj.nonsampleResp,obj.nonsampleVar);
0377             obj.nonsampleCI.ci68=ci68;
0378             obj.nonsampleCI.ci95=ci95;
0379             obj.nonsampleCI.ci99=ci99;
0380         <span class="keyword">end</span>
0381         <span class="comment">%extract CI</span>
0382         <a name="_sub26" href="#_subfunctions" class="code">function [ci68,ci95,ci99]=CI(obj,nonsamplePts)</a>
0383             <span class="comment">%store non sample points</span>
0384             <span class="keyword">if</span> nargin&gt;1;obj.nonsamplePts=nonsamplePts;<span class="keyword">end</span>
0385             <span class="comment">%eval the CI</span>
0386             [ci68,ci95,ci99]=<a href="../GRENAT/src/crit/BuildCI.html" class="code" title="function [ci68,ci95,ci99]=BuildCI(ZZ,var)">BuildCI</a>(obj.nonsampleResp,obj.nonsampleVar);
0387             obj.nonsampleCI.ci68=ci68;
0388             obj.nonsampleCI.ci95=ci95;
0389             obj.nonsampleCI.ci99=ci99;
0390         <span class="keyword">end</span>
0391         <span class="comment">%compute and show the errors of the metamodel (using reference if it is</span>
0392         <span class="comment">%available)</span>
0393         <a name="_sub27" href="#_subfunctions" class="code">function errCalc(obj)</a>
0394             obj.err=<a href="../GRENAT/src/crit/critErrDisp.html" class="code" title="function [err,errV,errNAME]=critErrDisp(Zap,Zref,data)">critErrDisp</a>(obj.nonsampleResp,obj.respRef,obj.dataTrain.build);
0395             obj.runErr=false;
0396         <span class="keyword">end</span>
0397         <span class="comment">%define the reference surface</span>
0398         <a name="_sub28" href="#_subfunctions" class="code">function defineRef(obj,varargin)</a>
0399             <span class="comment">%accepted keyword</span>
0400             keyOk={<span class="string">'sampleRef'</span>,<span class="string">'respRef'</span>,<span class="string">'gradRef'</span>};
0401             <span class="comment">%two kind of input variables list (with keywords or not)</span>
0402             <span class="comment">%depend on the first argument: double for classical list of</span>
0403             <span class="comment">%argument or string if the use of keywords</span>
0404             execOk=true;
0405             <span class="keyword">if</span> isa(varargin{1},<span class="string">'double'</span>)
0406                 <span class="keyword">if</span> nargin&gt;1;obj.sampleRef=varargin{1};obj.nonsamplePts=varargin{1};<span class="keyword">end</span>
0407                 <span class="keyword">if</span> nargin&gt;2;obj.respRef=varargin{2};<span class="keyword">end</span>
0408                 <span class="keyword">if</span> nargin&gt;3;obj.gradRef=varargin{3};<span class="keyword">end</span>
0409             <span class="keyword">elseif</span> isa(varargin{1},<span class="string">'char'</span>)
0410                 <span class="keyword">if</span> mod(nargin-1,2)==0
0411                     <span class="keyword">for</span> itV=1:2:nargin-1
0412                         <span class="comment">%load key and associated value</span>
0413                         keyTxt=varargin{itV};
0414                         keyVal=varargin{itV+1};
0415                         <span class="comment">%check if the keyword is usable</span>
0416                         <span class="keyword">if</span> ismember(keyTxt,keyOk)
0417                             <span class="comment">%store the data</span>
0418                             obj.(keyTxt)=keyVal;
0419                         <span class="keyword">else</span>
0420                             execOk=false;
0421                         <span class="keyword">end</span>
0422                     <span class="keyword">end</span>
0423                 <span class="keyword">else</span>
0424                     execOk=false;
0425                 <span class="keyword">end</span>
0426             <span class="keyword">else</span>
0427                 execOk=false;
0428             <span class="keyword">end</span>
0429             <span class="comment">%display error message if wrong syntax</span>
0430             <span class="keyword">if</span> ~execOk
0431                 fprintf(<span class="string">'Wrong syntax for the method\n'</span>)
0432                 fprintf(<span class="string">'defineref(sampleRef,respRef,gradRef)\n'</span>)
0433                 fprintf(<span class="string">'or defineref(''sampleRef'',val1,''respRef'',val2,''gradRef'',val3)\n'</span>)
0434             <span class="keyword">end</span>
0435         <span class="keyword">end</span>
0436         <span class="comment">%check if all data is available for displaying the reference</span>
0437         <span class="comment">%surface and gradients</span>
0438         <a name="_sub29" href="#_subfunctions" class="code">function [okAll,okSample,okResp,okGrad]=checkRef(obj)</a>
0439             okSample=false;
0440             okResp=false;
0441             okGrad=false;
0442             nbSRef(1)=size(obj.sampleRef,1);
0443             nbSRef(2)=size(obj.sampleRef,2);
0444             nbSRef(3)=size(obj.sampleRef,3);
0445             nbRRef(1)=size(obj.respRef,1);
0446             nbRRef(2)=size(obj.respRef,2);
0447             nbRRef(3)=size(obj.respRef,3);
0448             nbGRef(1)=size(obj.gradRef,1);
0449             nbGRef(2)=size(obj.gradRef,2);
0450             nbGRef(3)=size(obj.gradRef,3);
0451             <span class="keyword">if</span> sum(nbSRef(:))~=0
0452                 okSample=true;
0453                 <span class="keyword">if</span> nbSRef(1)==nbRRef(1)
0454                     okResp=true;
0455                 <span class="keyword">end</span>
0456                 <span class="keyword">if</span> nbGRef(3)==1
0457                     <span class="keyword">if</span> nbGRef(1)==nbSRef(1)&amp;&amp;nbGRef(2)==nbSRef(2)
0458                         okGrad=true;
0459                     <span class="keyword">end</span>
0460                 <span class="keyword">elseif</span> nbGRef(3)==nbSRef(2)&amp;&amp;nbGRef(1)==nbSRef(1)
0461                     okGrad=true;
0462                 <span class="keyword">elseif</span> all(nbGRef==nbSRef)
0463                     okGrad=true;
0464                 <span class="keyword">end</span>
0465             <span class="keyword">end</span>
0466             okAll=okSample&amp;&amp;okResp&amp;&amp;okGrad;
0467             <span class="comment">%display error messages</span>
0468             <span class="keyword">if</span> ~okSample;fprintf(<span class="string">'&gt;&gt; Wrong definition of the reference sample points\n'</span>);<span class="keyword">end</span>
0469             <span class="keyword">if</span> ~okResp;fprintf(<span class="string">'&gt;&gt; Wrong definition of the reference responses\n'</span>);<span class="keyword">end</span>
0470             <span class="keyword">if</span> ~okGrad;fprintf(<span class="string">'&gt;&gt; Wrong definition of the reference gradients\n'</span>);<span class="keyword">end</span>
0471         <span class="keyword">end</span>
0472         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0473         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0474         <span class="comment">%define properties</span>
0475         <a name="_sub30" href="#_subfunctions" class="code">function conf(obj,varargin)</a>
0476             <span class="comment">%list properties</span>
0477             listProp=properties(obj);
0478             okConf=false;
0479             <span class="comment">%if a input variable is specifiec</span>
0480             <span class="keyword">if</span> nargin&gt;2
0481                 <span class="comment">%if the number of input argument is even</span>
0482                 <span class="keyword">if</span>  mod(nargin-1,2)==0
0483                     <span class="comment">%along the argument</span>
0484                     <span class="keyword">for</span> itV=1:2:nargin-1
0485                         <span class="comment">%extract keyword and associated value</span>
0486                         keyW=varargin{itV};
0487                         keyV=varargin{itV+1};
0488                         <span class="comment">%if the first argument is a string</span>
0489                         <span class="keyword">if</span> isa(varargin{1},<span class="string">'char'</span>)
0490                             <span class="comment">%check if the keyword is acceptable</span>
0491                             <span class="keyword">if</span> ismember(keyW,listProp)
0492                                 okConf=true;
0493                                 obj.(keyW)=keyV;
0494                             <span class="keyword">else</span>
0495                                 fprintf(<span class="string">'&gt;&gt; Wrong keyword ''%s''\n'</span>,keyW);
0496                             <span class="keyword">end</span>
0497                         <span class="keyword">end</span>
0498                     <span class="keyword">end</span>
0499                 <span class="keyword">end</span>
0500                 <span class="keyword">if</span> ~okConf
0501                     fprintf(<span class="string">'\nWrong syntax used for conf method\n'</span>)
0502                     fprintf(<span class="string">'use: conf(''key1'',val1,''key2'',val2...)\n'</span>)
0503                     fprintf(<span class="string">'\nList of the available keywords:\n'</span>);
0504                     <a href="#_sub42" class="code" title="subfunction dispTableTwoColumnsStruct(tableFiedIn,structIn)">dispTableTwoColumnsStruct</a>(listProp,obj.infoProp);
0505                 <span class="keyword">end</span>
0506             <span class="keyword">else</span>
0507                 fprintf(<span class="string">'Current configuration\n'</span>);
0508                 disp(obj);
0509             <span class="keyword">end</span>
0510         <span class="keyword">end</span>
0511         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0512         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0513         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0514         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0515         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0516         <span class="comment">%display the surrogate model</span>
0517         <a name="_sub31" href="#_subfunctions" class="code">function show(obj,varargin)</a>
0518             <span class="comment">%depending of the kind of data</span>
0519             <span class="keyword">if</span> obj.sizeNonSample(3)==2
0520                 obj.confDisp.conf(<span class="string">'d3'</span>,true,<span class="string">'contour'</span>,true);
0521                 <span class="comment">%if argument</span>
0522                 <span class="keyword">if</span> nargin&gt;1;obj.confDisp.conf(varargin{:});<span class="keyword">end</span>
0523                 <a href="#_sub34" class="code" title="subfunction show2D(obj)">show2D</a>(obj);
0524             <span class="keyword">elseif</span> obj.sizeNonSample(3)==1
0525                 obj.confDisp.conf(<span class="string">'d3'</span>,false,<span class="string">'d2'</span>,false);
0526                 <span class="comment">%if argument</span>
0527                 <span class="keyword">if</span> nargin&gt;1;obj.confDisp.conf(varargin{:});<span class="keyword">end</span>
0528                 <a href="#_sub33" class="code" title="subfunction show1D(obj)">show1D</a>(obj);
0529             <span class="keyword">end</span>
0530         <span class="keyword">end</span>
0531         <a name="_sub32" href="#_subfunctions" class="code">function show1D(obj)</a>
0532             figure;
0533             <span class="comment">%depend if the reference is available or not</span>
0534             <span class="keyword">if</span> <a href="#_sub30" class="code" title="subfunction [okAll,okSample,okResp,okGrad]=checkRef(obj)">checkRef</a>(obj);
0535                 obj.nbSubplot=231;
0536                 subplot(obj.nbSubplot);
0537                 obj.confDisp.conf(<span class="string">'samplePts'</span>,true,<span class="string">'sampleGrad'</span>,false);
0538                 <a href="#_sub35" class="code" title="subfunction showRespRef(obj)">showRespRef</a>(obj);
0539                 obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot)
0540                 <span class="comment">%remove display of sample points</span>
0541                 obj.confDisp.conf(<span class="string">'samplePts'</span>,true,<span class="string">'sampleGrad'</span>,true);
0542                 <a href="#_sub36" class="code" title="subfunction showGradRef(obj,nbG)">showGradRef</a>(obj);
0543                 obj.nbSubplot=obj.nbSubplot+1;
0544             <span class="keyword">else</span>
0545                 obj.nbSubplot=221;
0546             <span class="keyword">end</span>
0547             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0548             obj.confDisp.conf(<span class="string">'samplePts'</span>,true,<span class="string">'sampleGrad'</span>,false);
0549             <a href="#_sub37" class="code" title="subfunction showResp(obj)">showResp</a>(obj);
0550             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0551             <span class="comment">%remove display of sample points</span>
0552             obj.confDisp.conf(<span class="string">'samplePts'</span>,true,<span class="string">'sampleGrad'</span>,true);
0553             <a href="#_sub38" class="code" title="subfunction showGrad(obj,nbG)">showGrad</a>(obj);
0554             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0555             <a href="#_sub39" class="code" title="subfunction showCI(obj,ciVal,nonsamplePts)">showCI</a>(obj,[]);
0556         <span class="keyword">end</span>
0557         <a name="_sub33" href="#_subfunctions" class="code">function show2D(obj)</a>
0558             figure;
0559             <span class="comment">%depend if the reference is available or not</span>
0560             <span class="keyword">if</span> <a href="#_sub30" class="code" title="subfunction [okAll,okSample,okResp,okGrad]=checkRef(obj)">checkRef</a>(obj);
0561                 obj.nbSubplot=331;
0562                 subplot(obj.nbSubplot);
0563                 obj.confDisp.conf(<span class="string">'samplePts'</span>,true);
0564                 <a href="#_sub35" class="code" title="subfunction showRespRef(obj)">showRespRef</a>(obj);
0565                 obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot)
0566                 <span class="comment">%remove display of sample points</span>
0567                 obj.confDisp.conf(<span class="string">'samplePts'</span>,false,<span class="string">'sampleGrad'</span>,false);
0568                 <a href="#_sub36" class="code" title="subfunction showGradRef(obj,nbG)">showGradRef</a>(obj,1);
0569                 obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot)
0570                 <a href="#_sub36" class="code" title="subfunction showGradRef(obj,nbG)">showGradRef</a>(obj,2);
0571             <span class="keyword">else</span>
0572                 obj.nbSubplot=231;
0573             <span class="keyword">end</span>
0574             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0575             obj.confDisp.conf(<span class="string">'samplePts'</span>,true);
0576             <a href="#_sub37" class="code" title="subfunction showResp(obj)">showResp</a>(obj);
0577             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0578             <span class="comment">%remove display of sample points</span>
0579             obj.confDisp.conf(<span class="string">'samplePts'</span>,false,<span class="string">'sampleGrad'</span>,false,<span class="string">'gridGrad'</span>,false);
0580             <a href="#_sub38" class="code" title="subfunction showGrad(obj,nbG)">showGrad</a>(obj,1);
0581             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0582             <a href="#_sub38" class="code" title="subfunction showGrad(obj,nbG)">showGrad</a>(obj,2);
0583             obj.nbSubplot=obj.nbSubplot+1;subplot(obj.nbSubplot);
0584             <a href="#_sub39" class="code" title="subfunction showCI(obj,ciVal,nonsamplePts)">showCI</a>(obj,[]);
0585         <span class="keyword">end</span>
0586         <span class="comment">%display the reference surface</span>
0587         <a name="_sub34" href="#_subfunctions" class="code">function showRespRef(obj)</a>
0588             obj.confDisp.title=(<span class="string">'Reference'</span>);
0589             <a href="../GRENAT/src/disp/displaySurrogate.html" class="code" title="function figHandle=displaySurrogate(gridXY,Z,sampling,resp,grad,dispData)">displaySurrogate</a>(obj.sampleRef,obj.respRef,obj.sampling,obj.resp,obj.grad,obj.confDisp);
0590         <span class="keyword">end</span>
0591         <span class="comment">%display the reference gradients surface</span>
0592         <a name="_sub35" href="#_subfunctions" class="code">function showGradRef(obj,nbG)</a>
0593             <span class="comment">%default value</span>
0594             <span class="keyword">if</span> nargin==1;nbG=1;<span class="keyword">end</span>
0595             obj.confDisp.title=([<span class="string">'Gradients Reference /x'</span> num2str(nbG)]);
0596             <a href="../GRENAT/src/disp/displaySurrogate.html" class="code" title="function figHandle=displaySurrogate(gridXY,Z,sampling,resp,grad,dispData)">displaySurrogate</a>(obj.sampleRef,obj.gradRef(:,:,nbG),obj.sampling,obj.resp,obj.grad,obj.confDisp);
0597         <span class="keyword">end</span>
0598         <span class="comment">%display the response approximated by the metamodel</span>
0599         <a name="_sub36" href="#_subfunctions" class="code">function showResp(obj)</a>
0600             obj.confDisp.title=(<span class="string">'Approximated responses'</span>);
0601             <a href="../GRENAT/src/disp/displaySurrogate.html" class="code" title="function figHandle=displaySurrogate(gridXY,Z,sampling,resp,grad,dispData)">displaySurrogate</a>(obj.nonsamplePts,obj.nonsampleResp,obj.sampling,obj.resp,obj.grad,obj.confDisp);
0602         <span class="keyword">end</span>
0603         <span class="comment">%display the gradients approximated by the metamodel</span>
0604         <a name="_sub37" href="#_subfunctions" class="code">function showGrad(obj,nbG)</a>
0605             <span class="comment">%default value</span>
0606             <span class="keyword">if</span> nargin==1;nbG=1;<span class="keyword">end</span>
0607             obj.confDisp.title=([<span class="string">'Approximated gradients /x'</span> num2str(nbG)]);
0608             <a href="../GRENAT/src/disp/displaySurrogate.html" class="code" title="function figHandle=displaySurrogate(gridXY,Z,sampling,resp,grad,dispData)">displaySurrogate</a>(obj.nonsamplePts,obj.nonsampleGrad(:,:,nbG),obj.sampling,obj.resp,obj.grad,obj.confDisp);
0609         <span class="keyword">end</span>
0610         <span class="comment">%display the confidence intervals approximated by the metamodel</span>
0611         <a name="_sub38" href="#_subfunctions" class="code">function showCI(obj,ciVal,nonsamplePts)</a>
0612             <span class="comment">%type of confidence intervals</span>
0613             ciOk=false;ciValDef=95;
0614             <span class="keyword">if</span> nargin&gt;1;<span class="keyword">if</span> ~isempty(ciVal);<span class="keyword">if</span> ismember(ciVal,[68,95,99]);ciOk=true;<span class="keyword">end</span>, <span class="keyword">end</span>, <span class="keyword">end</span>
0615             <span class="keyword">if</span> ~ciOk;ciVal=ciValDef;<span class="keyword">end</span>
0616             <span class="comment">%store non sample points</span>
0617             <span class="keyword">if</span> nargin&gt;2;obj.nonsamplePts=nonsamplePts;<span class="keyword">end</span>
0618             obj.confDisp.title=([num2str(ciVal) <span class="string">'% confidence intervals'</span>]);
0619             <span class="comment">%evaluation of the confidence interval</span>
0620             <a href="#_sub26" class="code" title="subfunction [ci68,ci95,ci99]=evalCI(obj,nonsamplePts)">evalCI</a>(obj);
0621             <span class="comment">%load data to display</span>
0622             ciDisp=obj.nonsampleCI.([<span class="string">'ci'</span> num2str(ciVal)]);
0623             <span class="comment">%display the CI</span>
0624             <a href="../GRENAT/src/disp/displaySurrogateCI.html" class="code" title="function displaySurrogateCI(Xpts,ic,dispData,Z)">displaySurrogateCI</a>(obj.nonsamplePts,ciDisp,obj.confDisp,obj.nonsampleResp);
0625         <span class="keyword">end</span>
0626         <span class="comment">%overload isfield</span>
0627         <a name="_sub39" href="#_subfunctions" class="code">function isF=isfield(obj,field)</a>
0628             isF=isprop(obj,field);
0629         <span class="keyword">end</span>
0630     <span class="keyword">end</span>
0631 <span class="keyword">end</span>
0632 
0633 
0634 
0635 
0636 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0637 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0638 <span class="comment">%function for declaring the purpose of each properties</span>
0639 <a name="_sub40" href="#_subfunctions" class="code">function info=affectTxtProp()</a>
0640 info.type=<span class="string">'Type of the surrogate model'</span>;
0641 info.sampling=<span class="string">'Coordinates of the sample points'</span>;
0642 info.resp=<span class="string">'Value(s) of the responses at the sample points'</span>;
0643 info.grad=<span class="string">'Value(s) of the gradients at the sample points'</span>;
0644 info.samplingN=<span class="string">'Normalized coordinates of the sample points'</span>;
0645 info.respN=<span class="string">'Value(s) of the normalized responses at the sample points'</span>;
0646 info.gradN=<span class="string">'Value(s) of the normalized gradients at the sample points'</span>;
0647 info.nonsamplePts=<span class="string">'Coordinates of the non-sample points'</span>;
0648 info.nonsampleResp=<span class="string">'Value(s) of the approximated responses calculated at the non-sample points'</span>;
0649 info.nonsampleGrad=<span class="string">'Value(s) of the approximated gradients calculated at the non-sample points'</span>;
0650 info.nonsamplePtsN=<span class="string">'Normalized coordinates of the  non-sample points'</span>;
0651 info.nonsampleRespN=<span class="string">'Value(s) of the normalized approximated responses calculated at the non-sample points'</span>;
0652 info.nonsampleGradN=<span class="string">'Value(s) of the normalized approximated gradients calculated at the non-sample points'</span>;
0653 info.nonsampleVar=<span class="string">'Value(s) of the variance calculated at the non-sample points'</span>;
0654 info.nonsampleCI=<span class="string">'Structure containing the bounds of the confidence intervals (68%, 95%, 99%)'</span>;
0655 info.nonsampleEI=<span class="string">'Value(s) of the expected improvment calculated at the non-sample points'</span>;
0656 info.norm=<span class="string">'Structure containing the normalization data'</span>;
0657 info.normMeanS=<span class="string">'Mean value of the sample points (vector)'</span>;
0658 info.normStdS=<span class="string">'Standard deviation of the sample points (vector)'</span>;
0659 info.normMeanR=<span class="string">'Mean value of the responses'</span>;
0660 info.normStdR=<span class="string">'Standard deviation of the responses'</span>;
0661 info.err=<span class="string">'Structure containing the values of the error criteria'</span>;
0662 info.sampleRef=<span class="string">'Array of the sample points used for the reference response surface'</span>;
0663 info.respRef=<span class="string">'Array of the responses of the reference response surface'</span>;
0664 info.gradRef=<span class="string">'Array of the gradients of the reference response surface'</span>;
0665 info.confMeta=<span class="string">'Class object (initMeta) containing information about the configuration (metamodel) (conf method for modifying it)'</span>;
0666 info.dataTrain=<span class="string">'Structures containing data about the training of the surrogate model'</span>;
0667 info.confDisp=<span class="string">'Class object (initDisp) containing information about the display (conf method for modifying it)'</span>;
0668 info.miss=<span class="string">'Structure Containing information about the missing data'</span>;
0669 <span class="keyword">end</span>
0670 
0671 <span class="comment">%function display table with two columns of text</span>
0672 <a name="_sub41" href="#_subfunctions" class="code">function dispTableTwoColumnsStruct(tableFiedIn,structIn)</a>
0673 <span class="comment">%size of every components in tableA</span>
0674 sizeA=cellfun(@numel,tableFiedIn);
0675 maxA=max(sizeA);
0676 <span class="comment">%space after each component</span>
0677 spaceA=maxA-sizeA+3;
0678 spaceTxt=<span class="string">' '</span>;
0679 <span class="comment">%display table</span>
0680 <span class="keyword">for</span> itT=1:numel(tableFiedIn)
0681     fprintf(<span class="string">'%s%s%s\n'</span>,tableFiedIn{itT},spaceTxt(ones(1,spaceA(itT))),structIn.(tableFiedIn{itT}));
0682 <span class="keyword">end</span>
0683 <span class="keyword">end</span>
0684 
0685 <span class="comment">%function display table with two columns of text</span>
0686 <a name="_sub42" href="#_subfunctions" class="code">function dispTableTwoColumns(tableA,tableB)</a>
0687 <span class="comment">%size of every components in tableA</span>
0688 sizeA=cellfun(@numel,tableA);
0689 maxA=max(sizeA);
0690 <span class="comment">%space after each component</span>
0691 spaceA=maxA-sizeA+3;
0692 spaceTxt=<span class="string">' '</span>;
0693 <span class="comment">%display table</span>
0694 <span class="keyword">for</span> itT=1:numel(tableA)
0695     fprintf(<span class="string">'%s%s%s\n'</span>,tableA{itT},spaceTxt(ones(1,spaceA(itT))),tableB{itT});
0696 <span class="keyword">end</span>
0697 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 04-Aug-2016 12:37:32 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>