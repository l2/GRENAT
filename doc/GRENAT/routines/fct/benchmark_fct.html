<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of benchmark_fct</title>
  <meta name="keywords" content="benchmark_fct">
  <meta name="description" content="benchmark de test des fonctions de correlation (tps calcul)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html GRENAT --><!-- # routines --><!-- menu.html fct -->
<h1>benchmark_fct
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>benchmark de test des fonctions de correlation (tps calcul)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> benchmark de test des fonctions de correlation (tps calcul)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% benchmark de test des fonctions de correlation (tps calcul)</span>
0002 clear all
0003 close all
0004 
0005 typef=<span class="string">'corr_'</span>; <span class="comment">%'rf_' ou 'corr_'</span>
0006 fct=<span class="string">'sexp'</span>;
0007 
0008 fct_all=[typef fct];
0009 
0010 <span class="comment">%%nouvelle et ancienne version</span>
0011 new=<span class="string">'_new'</span>;old=<span class="string">'_old'</span>;
0012 <span class="comment">%points en 1D, 2D, 3D, 4D, 5D et 6D</span>
0013 pt{1}=0.1;
0014 pt{2}=[0.1 -0.3];
0015 pt{3}=[0.1 -0.3 0.6];
0016 pt{4}=[0.1 -0.3 0.6 0.8];
0017 pt{5}=[0.1 -0.3 0.6 0.8 -0.1];
0018 pt{6}=[0.1 -0.3 0.6 0.8 -0.1 -0.4];
0019 dim=6;
0020 <span class="comment">%nombre points</span>
0021 nb_pt=5000;
0022 pas=50;
0023 <span class="comment">%parametre</span>
0024 para=0.9;
0025 <span class="comment">%borne verification</span>
0026 verif=1e-10;
0027 bilan=true;
0028 <span class="comment">%affichage</span>
0029 aff=false;
0030 
0031 stps_new=zeros(dim,length(1:pas:nb_pt),3);
0032 stps_old=zeros(dim,length(1:pas:nb_pt),3);
0033 sgain=zeros(dim,length(1:pas:nb_pt),3);
0034 ite_j=1;
0035 <span class="comment">%balayage des possibilit�s</span>
0036 <span class="keyword">for</span> ii=1:dim
0037     fprintf(<span class="string">'============\n'</span>),
0038     fprintf(<span class="string">'Dimension %i\n'</span>,ii);
0039     ite_j=1;
0040     <span class="keyword">for</span> jj=1:pas:nb_pt
0041         <span class="keyword">if</span> aff;fprintf(<span class="string">'nb de pts %i\n'</span>,jj);<span class="keyword">end</span>
0042         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0043         <span class="comment">%calcul reponse seule</span>
0044         <span class="keyword">if</span> aff;fprintf(<span class="string">'&gt;&gt;Reponses seules\n'</span>);<span class="keyword">end</span>
0045         tic
0046         rep_new=feval([fct_all new],repmat(pt{ii},jj,1),para);
0047         tps_new=toc;
0048         tic
0049         rep_old=feval([fct_all old],repmat(pt{ii},jj,1),para);
0050         tps_old=toc;
0051         gain=(tps_old-tps_new)/tps_old;
0052         stps_new(ii,ite_j,1)=tps_new;
0053         stps_old(ii,ite_j,1)=tps_old;
0054         sgain(ii,ite_j,1)=gain;
0055         etat_rep=all(abs(rep_new-rep_old)&lt;verif);
0056         bilan=bilan&amp;&amp;etat_rep;
0057         <span class="keyword">if</span> aff;
0058             fprintf(<span class="string">'Reponses: '</span>);<span class="keyword">if</span> etat_rep;fprintf(<span class="string">'OK\n'</span>);<span class="keyword">else</span> fprintf(<span class="string">'BUG\n'</span>);<span class="keyword">end</span> 
0059         <span class="keyword">end</span>
0060         <span class="keyword">if</span> aff;fprintf(<span class="string">'Temps: NEW [%4.2e s]// OLD [%4.2e s] || GAIN: %4.2e\n'</span>,tps_new,tps_old,gain);<span class="keyword">end</span>
0061         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0062         <span class="comment">%calcul reponse et derivees premieres</span>
0063         <span class="keyword">if</span> aff;fprintf(<span class="string">'&gt;&gt;Reponses et derivees premieres\n'</span>);<span class="keyword">end</span>
0064         tic
0065         [rep_new,drep_new]=feval([fct_all new],repmat(pt{ii},jj,1),para);
0066         tps_new=toc;
0067         tic
0068         [rep_old,drep_old]=feval([fct_all old],repmat(pt{ii},jj,1),para);
0069         tps_old=toc;
0070         gain=(tps_old-tps_new)/tps_old;
0071         stps_new(ii,ite_j,2)=tps_new;
0072         stps_old(ii,ite_j,2)=tps_old;
0073         sgain(ii,ite_j,2)=gain;
0074         etat_rep=all(abs(rep_new-rep_old)&lt;verif);
0075         etat_drep=all(abs(drep_new(:)-drep_old(:))&lt;verif);
0076         bilan=bilan&amp;&amp;etat_rep&amp;&amp;etat_drep;
0077         <span class="keyword">if</span> aff;
0078             fprintf(<span class="string">'Reponses: '</span>);<span class="keyword">if</span> etat_rep;fprintf(<span class="string">'OK\n'</span>);<span class="keyword">else</span> fprintf(<span class="string">'BUG\n'</span>);<span class="keyword">end</span> 
0079         <span class="keyword">end</span>
0080         <span class="keyword">if</span> aff;
0081             fprintf(<span class="string">'Derivees 1eres: '</span>);<span class="keyword">if</span> etat_drep;fprintf(<span class="string">'OK\n'</span>);<span class="keyword">else</span> fprintf(<span class="string">'BUG\n'</span>);<span class="keyword">end</span> 
0082         <span class="keyword">end</span>
0083         <span class="keyword">if</span> aff;fprintf(<span class="string">'Temps: NEW [%4.2e s]// OLD [%4.2e s] || GAIN: %4.2e\n'</span>,tps_new,tps_old,gain);<span class="keyword">end</span>
0084         <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0085         <span class="comment">%calcul reponse et derivees premieres et secondes</span>
0086         <span class="keyword">if</span> aff;fprintf(<span class="string">'&gt;&gt;Reponses et derivees premieres et secondes\n'</span>);<span class="keyword">end</span>
0087         tic
0088         [rep_new,drep_new,ddrep_new]=feval([fct_all new],repmat(pt{ii},jj,1),para);
0089         tps_new=toc;
0090         tic
0091         [rep_old,drep_old,ddrep_old]=feval([fct_all old],repmat(pt{ii},jj,1),para);
0092         tps_old=toc;
0093         gain=(tps_old-tps_new)/tps_old;
0094         stps_new(ii,ite_j,3)=tps_new;
0095         stps_old(ii,ite_j,3)=tps_old;
0096         sgain(ii,ite_j,3)=gain;
0097         etat_rep=all(abs(rep_new-rep_old)&lt;verif);
0098         etat_drep=all(abs(drep_new(:)-drep_old(:))&lt;verif);
0099         etat_ddrep=all(abs(ddrep_new(:)-ddrep_old(:))&lt;verif);
0100         bilan=bilan&amp;&amp;etat_rep&amp;&amp;etat_drep&amp;&amp;etat_ddrep;
0101         <span class="keyword">if</span> aff;
0102             fprintf(<span class="string">'Reponses: '</span>);<span class="keyword">if</span> etat_rep;fprintf(<span class="string">'OK\n'</span>);<span class="keyword">else</span> fprintf(<span class="string">'BUG\n'</span>);<span class="keyword">end</span> 
0103         <span class="keyword">end</span>
0104         <span class="keyword">if</span> aff;
0105             fprintf(<span class="string">'Derivees 1eres: '</span>);<span class="keyword">if</span> etat_drep;fprintf(<span class="string">'OK\n'</span>);<span class="keyword">else</span> fprintf(<span class="string">'BUG\n'</span>);<span class="keyword">end</span> 
0106         <span class="keyword">end</span>
0107         <span class="keyword">if</span> aff;
0108             fprintf(<span class="string">'Derivees 2ndes: '</span>);<span class="keyword">if</span> etat_ddrep;fprintf(<span class="string">'OK\n'</span>);<span class="keyword">else</span> fprintf(<span class="string">'BUG\n'</span>);<span class="keyword">end</span> 
0109         <span class="keyword">end</span>
0110         <span class="keyword">if</span> aff;fprintf(<span class="string">'Temps: NEW [%4.2e s]// OLD [%4.2e s] || GAIN: %4.2e\n'</span>,tps_new,tps_old,gain);<span class="keyword">end</span>
0111         ite_j=ite_j+1;
0112        
0113     <span class="keyword">end</span>
0114 <span class="keyword">end</span>
0115 <span class="keyword">if</span> bilan;fprintf(<span class="string">'\n\n TOUT: OK\n'</span>);<span class="keyword">else</span> fprintf(<span class="string">'\n\n TOUT: BUG\n'</span>);<span class="keyword">end</span>
0116 
0117 <span class="comment">%trac� graphs</span>
0118 figure
0119 xx=1:pas:nb_pt;
0120 <span class="keyword">for</span> ii=1:dim
0121     subplot(2,3,ii)    
0122     semilogy(xx,stps_new(ii,:,1),<span class="string">'b'</span>)
0123     hold on
0124     semilogy(xx,stps_old(ii,:,1),<span class="string">'r'</span>)
0125     hold on
0126     semilogy(xx,stps_new(ii,:,2),<span class="string">'--b'</span>)
0127     hold on
0128     semilogy(xx,stps_old(ii,:,2),<span class="string">'--r'</span>)
0129     hold on
0130     semilogy(xx,stps_new(ii,:,3),<span class="string">'.-b'</span>)
0131     hold on
0132     semilogy(xx,stps_old(ii,:,3),<span class="string">'.-r'</span>)
0133     legend(<span class="string">'new R'</span>,<span class="string">'old R'</span>,<span class="string">'new R,D1'</span>,<span class="string">'old R,D1'</span>,<span class="string">'new R,D1,D2'</span>,<span class="string">'old R,D1,D2'</span>)
0134     title([<span class="string">'Dim '</span> num2str(ii)]);
0135     
0136 <span class="keyword">end</span>
0137 figure
0138 <span class="keyword">for</span> ii=1:dim
0139     subplot(2,3,ii)
0140     
0141     plot(xx,sgain(ii,:,1),<span class="string">'k'</span>)
0142     hold on
0143     plot(xx,sgain(ii,:,2),<span class="string">'r'</span>)
0144     hold on
0145     plot(xx,sgain(ii,:,3),<span class="string">'b'</span>)
0146     legend(<span class="string">'R'</span>,<span class="string">'R,D1'</span>,<span class="string">'R,D1,D2'</span>)
0147     title([<span class="string">'Dim '</span> num2str(ii)]);
0148 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 27-Aug-2015 11:57:14 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>