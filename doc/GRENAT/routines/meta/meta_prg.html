<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of meta_prg</title>
  <meta name="keywords" content="meta_prg">
  <meta name="description" content="%fonction permettant d'etablir une regression polynomiale à partir d'un">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html GRENAT --><!-- # routines --><!-- menu.html meta -->
<h1>meta_prg
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>%fonction permettant d'etablir une regression polynomiale à partir d'un</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [B,MSE]=meta_prg(xx,eval,deg) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">%fonction permettant d'etablir une regression polynomiale à partir d'un
%ensemble de points</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="const_meta.html" class="code" title="function [ret]=const_meta(tirages,eval,grad_in,meta,num_fct)">const_meta</a>	% fonction assurant la construction du metamodele (pas son evaluation)</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%%fonction permettant d'etablir une regression polynomiale à partir d'un</span>
0002 <span class="comment">%%ensemble de points</span>
0003 
0004 <span class="comment">%%L. LAURENT      luc.laurent@ens-cachan.fr</span>
0005 <span class="comment">%% 10/03/2010</span>
0006 
0007 
0008 <a name="_sub0" href="#_subfunctions" class="code">function [B,MSE]=meta_prg(xx,eval,deg)</a>
0009 
0010 <span class="comment">%en dimension 1: xx et eval doivent etre des vecteurs colonne</span>
0011 
0012 <span class="comment">%constante</span>
0013 nb_pts=size(xx,1);
0014 dim=size(xx,2);
0015 
0016 <span class="keyword">if</span>(deg==1) <span class="comment">%%polynome de degre 1</span>
0017     matx=zeros(nb_pts,1+dim);
0018     matx(:,1)=ones(nb_pts,1);
0019     matx(:,2:dim+1)=xx;
0020     fs=eval;
0021     
0022 <span class="keyword">elseif</span>(deg==2)  <span class="comment">%%polynome de degre 2</span>
0023     <span class="comment">%nombre de colonne</span>
0024     ncl=(dim+1)*(dim+2)/2;
0025     matx=zeros(nb_pts,ncl);
0026     matx(:,1)=ones(nb_pts,1);
0027     matx(:,2:dim+1)=xx;
0028     j=dim+1;q=dim;
0029     <span class="keyword">for</span> ii=1:dim
0030         matx(:,j+(1:q)) = repmat(xx(:,ii),1,q) .* xx(:,ii:dim);
0031         j = j+q;   q = q-1;
0032     <span class="keyword">end</span>
0033     fs=eval;
0034     
0035     
0036     
0037 <span class="keyword">elseif</span>(deg==3)  <span class="comment">%%polynome de degre 3</span>
0038     
0039     <span class="keyword">if</span> dim==1
0040         matx=[ones(size(eval,1),1) xx xx.^2 xx.^3];
0041     <span class="keyword">elseif</span> dim==2
0042         matx=[ones(size(eval,1),1) xx(:,1) xx(:,2) xx(:,1).^2 xx(:,2).^2 xx(:,1).*xx(:,2) xx(:,1).^3 <span class="keyword">...</span>
0043             xx(:,2).^3 xx(:,1).^2.*xx(:,2) xx(i,1).*xx(i,2).^2];
0044     <span class="keyword">else</span>
0045         error(<span class="string">'Dimension non prise en charge'</span>);
0046     <span class="keyword">end</span>
0047     fs=eval;
0048     
0049     
0050 <span class="keyword">elseif</span>(deg==4)  <span class="comment">%%polynome de degre 4</span>
0051     <span class="keyword">if</span> dim==1
0052         matx=[ones(size(eval,1),1) xx xx.^2 xx.^3 xx.^4];
0053     <span class="keyword">elseif</span> dim==2
0054         matx=[ones(size(eval,1),1) xx(:,1) xx(:,2) xx(:,1)^2 xx(:,2)^2 xx(:,1)*xx(:,2) xx(:,1)^3 <span class="keyword">...</span>
0055             xx(:,2)^3 xx(:,1)^2*xx(:,2) xx(:,1)*xx(:,2)^2 <span class="keyword">...</span>
0056             xx(:,1)^4 xx(:,2)^4 xx(:,1)^3*xx(:,2) xx(:,1)*xx(:,2)^3 xx(:,1)^2*xx(:,2)^2];
0057     <span class="keyword">else</span>
0058         error(<span class="string">'Dimension non prise en charge'</span>);
0059     <span class="keyword">end</span>
0060     fs=eval;
0061     
0062 <span class="keyword">else</span>
0063     error(<span class="string">'Degre de polynome non encore pris en comtpe'</span>);
0064 <span class="keyword">end</span>
0065 
0066 <span class="comment">%%Determination des coefficients du polynome</span>
0067 <span class="comment">%  f(x)=a0+a1*x1+a2*x2+a11*x1²+a22*x2²+a12*x1*x2</span>
0068 <span class="comment">% B=[a0 a1 a2 a11 a22 a12]; polynome de degre 2</span>
0069 
0070 B=inv(matx'*matx)*matx'*fs;
0071 <span class="keyword">if</span> nargout==2
0072     MSE=B'*matx'*matx*B-2*B'*matx'*fs+fs'*fs;
0073 <span class="keyword">end</span>
0074 <span class="keyword">end</span>
0075</pre></div>
<hr><address>Generated on Fri 07-Feb-2014 20:13:17 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>