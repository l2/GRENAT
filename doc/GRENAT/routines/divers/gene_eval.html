<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of gene_eval</title>
  <meta name="keywords" content="gene_eval">
  <meta name="description" content="%Evaluation de la fonction et de ses gradients">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html GRENAT --><!-- # routines --><!-- menu.html divers -->
<h1>gene_eval
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>%Evaluation de la fonction et de ses gradients</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [eval,grad]=gene_eval(fct,X,type) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">%Evaluation de la fonction et de ses gradients
% L. LAURENT -- 17/12/2010 -- laurent@lmt.ens-cachan.fr</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="mesu_time.html" class="code" title="function [tictoc_compt,tInit]=mesu_time(compteur,tps_init)">mesu_time</a>	% Fonction assurant l'initialisation et l'affichage des infos temporelles dans les fonctions</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../GRENAT/EXEMPLE_UTILISATION_DOE.html" class="code" title="">EXEMPLE_UTILISATION_DOE</a>	Exemple d'utilisation de la Toolbox GRENAT couplee avec LMTir</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%%Evaluation de la fonction et de ses gradients</span>
0002 <span class="comment">%% L. LAURENT -- 17/12/2010 -- laurent@lmt.ens-cachan.fr</span>
0003 
0004 <a name="_sub0" href="#_subfunctions" class="code">function [eval,grad]=gene_eval(fct,X,type)</a>
0005 
0006 
0007 [tMesu,tInit]=<a href="mesu_time.html" class="code" title="function [tictoc_compt,tInit]=mesu_time(compteur,tps_init)">mesu_time</a>;
0008 <span class="comment">%test parallelisme</span>
0009 numw=0;
0010 <span class="keyword">if</span> ~isempty(whos(<span class="string">'parallel'</span>,<span class="string">'global'</span>))
0011     <span class="keyword">global</span> parallel
0012     numw=parallel.num;
0013 <span class="keyword">end</span>
0014 <span class="comment">% en fonction du type d'évaluation (calcul au points tirés ou calcul pour</span>
0015 <span class="comment">% affichage)</span>
0016 <span class="keyword">switch</span> type
0017     <span class="comment">%evaluations des pts tirées (X est une matrice: 1var par colonne)</span>
0018     <span class="keyword">case</span> <span class="string">'eval'</span>
0019         fprintf(<span class="string">'=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=\n'</span>)
0020         fprintf(<span class="string">'  &gt;&gt;&gt;        EVALUATION FONCTION      &lt;&lt;&lt;\n'</span>);
0021         <span class="comment">%% X matrice de tirages:</span>
0022         <span class="comment">% colonnes: chaque dimension</span>
0023         <span class="comment">% lignes: un jeu de paramètres</span>
0024         nb_var=size(X,2);
0025         nb_val=size(X,1);
0026         <span class="comment">%X</span>
0027         
0028         <span class="comment">%préparation jeu de données pour evaluation</span>
0029         X_eval=zeros(nb_val,1,nb_var);
0030         
0031         parfor (ii=1:nb_var,numw)
0032             X_eval(:,:,ii)=X(:,ii);
0033         <span class="keyword">end</span>
0034         <span class="comment">%évaluation pour affichage (X est une matrice de matrice)</span>
0035     <span class="keyword">case</span> <span class="string">'aff'</span>
0036         fprintf(<span class="string">'=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=\n'</span>)
0037         fprintf(<span class="string">'  &gt;&gt;&gt; EVALUATION FONCTION (affichage) &lt;&lt;&lt;\n'</span>);
0038         X_eval=X;
0039         nb_var=size(X,3);
0040         nb_val=size(X,1);
0041 <span class="keyword">end</span>
0042 
0043 <span class="comment">%evaluation fonction et gradients aux points x</span>
0044 <span class="keyword">if</span> nargout==1
0045     [eval]=feval(fct,X_eval);
0046 <span class="keyword">elseif</span> nargout==2
0047     [eval,gradb]=feval(fct,X_eval);
0048     <span class="comment">% dans le cas des évaluations aux points tirés on reorganise les</span>
0049     <span class="comment">% gradients</span>
0050     <span class="keyword">if</span> strcmp(type,<span class="string">'eval'</span>)
0051         grad=zeros(size(X));
0052         parfor (ii=1:nb_var,numw)
0053            grad(:,ii)=gradb(:,:,ii); 
0054         <span class="keyword">end</span>
0055     <span class="keyword">else</span>
0056         grad=gradb;
0057     <span class="keyword">end</span>
0058 <span class="keyword">else</span>
0059     fprintf(<span class="string">'Mauvais nombre de paramètres de sortie (cf. gene_eval)'</span>);
0060 <span class="keyword">end</span>
0061 
0062 fprintf(<span class="string">' &gt;&gt; Evaluation de la fonction %s en %i pts (%iD)\n'</span>,fct,nb_val,nb_var);
0063 fprintf(<span class="string">' &gt;&gt; Calcul des gradients: '</span>);
0064 <span class="keyword">if</span> nargout==2;fprintf(<span class="string">'Oui\n'</span>);<span class="keyword">else</span> fprintf(<span class="string">'Non\n'</span>);<span class="keyword">end</span>
0065 
0066 <a href="mesu_time.html" class="code" title="function [tictoc_compt,tInit]=mesu_time(compteur,tps_init)">mesu_time</a>(tMesu,tInit);
0067 fprintf(<span class="string">'=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=\n'</span>)</pre></div>
<hr><address>Generated on Fri 07-Feb-2014 20:13:17 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>