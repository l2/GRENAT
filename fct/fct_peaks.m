%fonction peaks 
%L. LAURENT -- 12/05/2010 -- luc.laurent@ens-cachan.fr

function [p,dp1,dp2]=fct_peaks(xx,yy)

p =  3*(1-xx).^2.*exp(-(xx.^2) - (yy+1).^2) ...
   - 10*(xx/5 - xx.^3 - yy.^5).*exp(-xx.^2-yy.^2) ...
   - 1/3*exp(-(xx+1).^2 - yy.^2);

if nargout==3
   dp1=-6*(1-xx).*exp(-(xx.^2) - (yy+1).^2)...
       -6*xx.*(1-xx).^2.*exp(-xx.^2-(yy+1).^2) ...
       -10*(1/5-3*xx.^2).*exp(-xx.^2-yy.^2)...
       +20*(xx/5-xx.^3-yy.^5).*xx.*exp(-xx.^2-yy.^2)...
       +2/3*(xx+1).*exp(-(xx+1).^2-yy.^2);
   dp2=-6*(1-xx).^2.*(yy+1).*exp(-xx.^2-(yy+1).^2)...
       +50*yy.^4.*exp(-xx.^2-yy.^2)...
       +20*yy.*(xx/5-xx.^3-yy.^5).*exp(-xx.^2 -yy.^2)...
       +2/3*yy.*exp(-(xx+1).^2-yy.^2);
end
end